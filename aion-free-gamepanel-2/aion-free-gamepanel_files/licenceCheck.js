(function(){define(["exports","packages/jquery","packages/backbone","packages/event-bus","global/launcher"],function(exports,e,n,c,t){var i,r,u,o,d,l,a;return l={},o=null,u=e.Deferred(),r=function(e){if(window.Inn.bind("a4g-frame-closed",document.documentElement),null!=e)return window.Inn.unbind("licence-accepted-"+e,document.documentElement)},i=function(e,n){if(r(e),o.unset("Layout/service."+e+".waitingForLicenceAccept"),o.set("Layout/service."+e+".licenceAccepted",!0),e in l&&delete l[e],exports.trigger("accept",e),null!=n)return n(!0)},d=function(e,n){if(!o.get("Layout/service."+e+".licenceAccepted"))return r(e),o.unset("Layout/service."+e+".waitingForLicenceAccept"),exports.trigger("reject",e),null!=n?n(!1):void 0},a=function(e){var n,c,t,i;for(l={},i=[],n=0,t=e.length;n<t;n++)c=e[n],l[c.serviceId]||(l[c.serviceId]=[]),i.push(l[c.serviceId].push(c));return i},e(document).one("l4g-model-ready",function(e,n){return o=n.model,t.accountData().then(function(e){return a(e["unaccepted-licences"]||[]),u.resolve()})}),e.extend(exports,n.Events,{inited:function(e){return u.done(e)},shouldBlockAutoreload:function(e){return!0},acceptRequired:function(n){return!(!o||o.get("L4G.User/guest"))&&(!o.get("Layout/services."+n+".waitingForLicenceAccept"||e("#LicencePopup").length)&&n in l)},showLicence:function(e,n){var c;if(c="Layout/services."+e+".waitingForLicenceAccept",!o.get(c))return o.set(c,!0),window.Inn.bind("licence-accepted-"+e,document.documentElement,i.bind(null,e,n)),window.Inn.bind("a4g-frame-closed",document.documentElement,d.bind(null,e,n)),window.A4G.licenceBeforeEnter({serviceId:e})},showLicenceIfNeeded:function(e,n){return!!this.acceptRequired(e)&&(this.showLicence(e,n),!0)}})})}).call(this);
//# sourceMappingURL=licenceCheck.js.map
