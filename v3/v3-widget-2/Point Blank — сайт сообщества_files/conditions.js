(function(){define(["packages/jquery","packages/che","packages/4game-api-client","global/launcher"],function(e,t,n,o){var r,i;return r=e(document),i=function(e,t){return o.userData().then(e,t)},{errors:{AUTH_REQUIRED:1,MOBILE_REQUIRED:2,INSUFFICIENT_CASH:3,USERDATA_ERROR:4,UNKNOWN_SERVICE:5,EMAIL_REQUIRED:6,EMAIL_OR_MOBILE_REQUIRED:7,FLAG_CHECK_FAILED:8},contactTypes:n.user.identityTypes,checkConditions:function(t,o,r){return null==r&&(r={}),i(function(i){return function(p){var c;return(null!=p?p.id:void 0)?!r.checkContacts||p.email||p.mobile?r.checkMobile&&!p.mobile?(i.openSetContactPopup(i.contactTypes.MOBILE),"function"==typeof o?o(i.errors.MOBILE_REQUIRED):void 0):r.checkEmail&&!p.email?(i.openSetContactPopup(),"function"==typeof o?o(i.errors.EMAIL_REQUIRED):void 0):(c=p.balance+p.bonus,!("price"in r)||c>=(r.price||0)?r.checkServiceFlags?r.serviceId?n.flags.getByApp(r.serviceId).then(function(r){var p,c,u,a,s,E;for(c=[],E=r.flags,u=0,a=E.length;u<a;u++)switch(p=E[u],p.name){case"USERNAME_REQUIRED":s=n.user.getContacts().then(function(e){return{name:p.name,success:e.firstName||e.lastName}}),c.push(s)}return e.when.apply(e,c).then(function(){var e,n,r;for(e=0,n=arguments.length;e<n;e++)if(r=arguments[e],!r.success)return"function"==typeof o?o(i.errors.FLAG_CHECK_FAILED,r.name):void 0;return"function"==typeof t?t():void 0})}):"function"==typeof o?o(i.errors.UNKNOWN_SERVICE):void 0:"function"==typeof t?t():void 0:(i.openPaymentPopup((r.price||0)-c,r.redirectTo),"function"==typeof o?o(i.errors.INSUFFICIENT_CASH):void 0)):(i.openSetContactPopup(),"function"==typeof o?o(i.errors.EMAIL_OR_MOBILE_REQUIRED):void 0):(i.openAuthPopup(r.redirectTo),"function"==typeof o?o(i.errors.AUTH_REQUIRED):void 0)}}(this),function(e){return function(){return"function"==typeof o?o(e.errors.USERDATA_ERROR):void 0}}(this))},openAuthPopup:function(e){return t.events.trigger("pageTransition:init",["?popupWidget=AuthPopupWidget"+(e?"&redirectTo="+encodeURIComponent(e):""),'AuthPopupWidget: {"target":"#OverlayContent","ns":"popup"}',"GET",{}])},openPaymentPopup:function(e,n){return t.events.trigger("pageTransition:init",["?popupWidget=PaymentTerminalWidget"+(e?"&suggest="+e:"")+(n?"&redirectTo="+encodeURIComponent(n):""),'PaymentTerminalWidget: {"target":"#OverlayContent","ns":"popup"}',"GET",{}])},openSetContactPopup:function(e){return null==e&&(e=this.contactTypes.EMAIL),t.events.trigger("pageTransition:init",["?popupWidget=SetContactWidget&contactType="+e,'SetContactWidget: {"target":"#OverlayContent","ns":"popup"}',"GET",{}])}}})}).call(this);
//# sourceMappingURL=conditions.js.map
