(function(){var e=function(e,n){function r(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;null==window.Inn&&(window.Inn={}),function(t){var n,r,o,a,i,c,d,l,u,s,m,p,f,y,h;return s=this,m=document.documentElement,r=!1,o="DOMReady",d=0,i={},h={},a=function(e,t,n){return h[t]||(h[t]={}),h[t][e]||(h[t][e]={}),!h[t][e][n]&&(document.addEventListener?t.addEventListener(e,n):document.attachEvent&&(null==t[e]&&t[e],t.attachEvent("onpropertychange",function(r){if(r.propertyName===e)return n.call(t)})),h[t][e][n]=!0,!0)},y=function(e,t,r){if(!t)throw new n("Cannot unbind from uknown target ;)");if(!t)throw new n("Cannot unbind unknown event ;)");return r?delete h[t][e][r]:delete h[t][e],!0},l=function(e,t){var n;return!(!h[t]||!h[t][e])&&(document.createEvent&&document.dispatchEvent?(n=document.createEvent("UIEvents"),n.initEvent(e,!0,!0),t.dispatchEvent(n),!0):!(!document.createEventObject||!document.fireEvent)&&(t[e]++,!0))},u=function(e,t){var n;return null!=(null!=(n=h[t])?n[e]:void 0)},c=function(e){return r?(e(),!0):(a(o,m,e),r||null==document.readyState||"complete"!==document.readyState?document.addEventListener?document.addEventListener("readystatechange",f):document.attachEvent("onreadystatechange",f):f(),!0)},f=function(){return document.removeEventListener?document.removeEventListener("readystatechange",f):document.detachEvent("onreadystatechange",f),r=!0,setTimeout(function(){return l(o,m,1)})},n=function(t){function n(e){this.message=e,this.name="InnError"}return e(n,t),n}(Error),c(function(){var e,t,n,r,o,a;if(n=document.getElementsByClassName("bLicensePopup__eButton")[0],e=document.getElementById("jsLicensePopup-btnPlay"),!e)return!1;if(e.removeAttribute("disabled"),r=document.getElementsByClassName("jsUICheckbox__eInput bUICheckbox__eInput")[0],a=document.getElementById("checkboxError"),o=function(){return r&&r.checked?(a.style.display="none",n.className=n.className.replace(/\s*halfOpacity/,"")):(n.className=n.className.replace(/\s*halfOpacity/,"")+" halfOpacity",r.className=r.className.replace(/\s*error/,""))},t=function(e){return e=e||window.event,r&&r.checked?a.style.display="none":r&&!r.checked?(a.style.display="block",e.stopPropagation(),e.preventDefault(),!1):void 0},document.addEventListener){if(null!=r&&r.addEventListener("change",o,!1),null!=e)return e.addEventListener("click",t,!1)}else if(null!=r&&r.attachEvent("onchange",o),null!=e)return e.attachEvent("onclick",t,!1)}),p=function(){var e,t,n;if(window.console&&window.console.log)i=window.console;else for(n=function(){return{}},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","markTimeline","table","time","timeEnd","timeStamp","trace","warn"],e=t.length;e--;)i[t[e]]=n;return i},t.Error=n,t.isNotEmptyString=function(e){return"string"==typeof e&&e.length},t.console=p(),t.bind=a,t.unbind=y,t.fire=l,t.hasEventListener=u,t.domReady=c,t}(window.Inn)}).call(this),function(){window.A4G=function(){var e,t,n,r,o,a,i,c,d,l,u,s,m,p,f,y,h,v,g,w,E,b,A,G,I,F,B,C;return b=this,s=window.Inn,p="ru",C={domain:{ru:"//ru-beta.4game.com/",en:"//eu.4game.com/",de:"//eu.4game.com/",pl:"//eu.4game.com/","pt-br":"//br.4game.com/"},download:"api/application/type/install/",updateApplication:"api/application/type/update/",licenceBeforePlay:"api/licence/type/beforePlay/",licenceBeforeEnter:"api/licence/type/unaccepted/"},A={licenceBeforePlaySubmit:"acceptLicenceBeforePlay",licenceBeforeEnterSubmit:"acceptLicenceBeforePlay",finish:"destroyA4GFrame",download:"downloadFileInIframe"},F=!0,v=0,B={A4GFrame:"A4GFrame",A4GFrameClassReady:"A4GFrame__mLoaded_true",A4GBodyClassOverflow:"A4GBody__isPopupVisible_true"},G=C.domain[p],I=window.location.protocol,m={inited:!1,body:!1},l=function(e){return function(e){var t;if(F=null!=(t=null!=e&&e.debug)&&t,!e)throw new s.Error("Must have options argument: {appdId: ..., otherOption: ...}");if(!e.appId)throw new s.Error("There is no 'appId' field in option argument");if(null!=e.lang&&null==C.domain[e.lang])throw new s.Error("Illegal language code");return s.domReady(function(){var t,n,r,i,c,d;if(m.inited)throw new s.Error("Second init occured!");for(m.body=document.getElementsByTagName("body")[0],null!=e.lang&&(p=e.lang,G=I+C.domain[p]),d=document.getElementsByTagName("script"),t=0,n=d.length;t<n;t++)c=d[t],(null!=(i=c.src)?i.indexOf("api4game"):void 0)>-1&&c.hasAttribute("data-domain")&&(r=c.getAttribute("data-domain"),"current"===r&&(r="//"+location.host),"/"!==r.charAt(r.length-1)&&(r+="/"),G=r.indexOf("http")>-1?"":I,G+=r);return a(),o(),m.inited=!0,"function"==typeof e.complete?e.complete():void 0})}}(this),o=function(){var e;return e=m,e.A4GFrame=document.createElement("iframe"),e.A4GFrame.setAttribute("id",B.A4GFrame),e.A4GFrame.setAttribute("name",B.A4GFrame),e.A4GFrame.setAttribute("allowTransparency","true"),document.attachEvent?(e.A4GFrame.attachEvent("onload",function(e){return document.attachEvent("onkeydown",n),u()}),window.attachEvent("onmessage",r)):(e.A4GFrame.addEventListener("load",function(e){return document.addEventListener("keydown",n),u()}),window.addEventListener("message",r))},r=function(e,n,r){var o,a,i,c,d,l;if(null!=e.data){o={type:e.data,data:null};try{o=JSON.parse(e.data),c=[];for(i in A)l=A[i],o.type===i?c.push(t[l](o.data)):c.push(void 0);return c}catch(u){a=u,d=[];for(i in A)l=A[i],e.data===i?d.push(t[l]()):d.push(void 0);return d}}},u=function(){var t,n;return t=m.body,s.fire("waiting-stop",document.documentElement),v&&(e(B.A4GBodyClassOverflow),window.outerHeight<document.documentElement.scrollHeight&&(t.style.marginRight=v+"px")),n=m.A4GFrame,n.contentWindow.postMessage("info",G),n.className+=" "+B.A4GFrameClassReady},g=function(e,t){var n,r,o;return s.fire("waiting-start",document.documentElement),n=m,n.A4GFrame.setAttribute("src",e),n.body.appendChild(n.A4GFrame),!v&&(r=document.createElement("div"),r.id="A4GScrollCalculatingContainer",r.style.position="fixed",r.style.top="-300px",r.style.left="0",r.style.width="100px",r.style.height="100px",r.style.overflow="scroll",o=document.createElement("div"),o.style.height="10px",o.style.width="auto",r.appendChild(o),n.body.appendChild(r),v=r.offsetWidth-(o.clientWidth||o.innerWidth))},i=function(){return document.removeEventListener?document.removeEventListener("keydown",n):document.detachEvent("onkeydown",n),v&&(h(B.A4GBodyClassOverflow),m.body.style.marginRight="0px"),m.body.removeChild(m.A4GFrame),m.A4GFrame.className="",s.fire("a4g-frame-closed",document.documentElement)},a=function(){var e,t,n,r,o,a,i,c,d;for(t=m,d=document.createElement("style"),d.setAttribute("data-a4g","a4g"),document.getElementsByTagName("head")[0].appendChild(d),r=document.styleSheets,e=0,n=r.length;e<n;e++)if(c=r[e],null!=(o=c.ownerNode)?o.getAttribute("data-a4g"):void 0){t.styleSheet=c;break}return a="padding: 0; margin: 0; position: fixed; border: 0; z-index: 9900; top: 0px; left: 0px; width: 100%; height: 100%; background: transparent; display: none; ",i="display: block;",null!=t.styleSheet.addRule?(t.styleSheet.addRule("body."+B.A4GBodyClassOverflow,"overflow: hidden !important;"),t.styleSheet.addRule("#"+B.A4GFrame,a),t.styleSheet.addRule("#"+B.A4GFrame+"."+B.A4GFrameClassReady,i)):null!=t.styleSheet.insertRule&&(t.styleSheet.insertRule("body."+B.A4GBodyClassOverflow+"{ overflow: hidden !important; }",0),t.styleSheet.insertRule("#"+B.A4GFrame+" {"+a+"}",0),t.styleSheet.insertRule("#"+B.A4GFrame+"."+B.A4GFrameClassReady+" {"+i+"}",0)),!0},e=function(e){var t;return t=m.body.className,m.body.className=t+" "+e+" "},h=function(e){return m.body.className=m.body.className.replace(" "+B.A4GBodyClassOverflow+" "," ")},n=function(e){if(27===e.keyCode)return i()},c=function(){var e,t,n;t=[];for(e in m)n=m[e],t.push(delete m[e]);return t},d=function(e){if(!e)throw new s.Error("Must have options argument");if(isNaN(e.serviceId))throw new s.Error("Must have 'options.serviceId' parameter, and it must be a number");if(!m.inited)throw new s.Error("A4G must be inited first");return g(G+C.download+"?serviceId="+e.serviceId)},E=function(e){return g(G+C.updateApplication)},y=function(e){return g(G+C.licenceBeforePlay+"?serviceId="+e.serviceId+"&licenceType="+e.licenceType)},f=function(e){return g(G+C.licenceBeforeEnter+"?serviceId="+e.serviceId)},t={acceptLicenceBeforePlay:function(e){if(null!=e.serviceId)return s.fire("licence-accepted-"+e.serviceId,document.documentElement)},destroyA4GFrame:function(){return i()},downloadFileInIframe:function(e){return window.location.href=e,require(["packages/che"],function(e){return e.events.trigger("gameDownload:started")})}},w=function(e){},{init:function(){return l.apply(b,arguments)},destruct:function(){return c.apply(c,arguments)},download:function(){return d.apply(d,arguments)},updateApplication:function(){return E.apply(E,arguments)},licenceBeforePlay:function(){return y.apply(y,arguments)},licenceBeforeEnter:function(){return f.apply(f,arguments)},register:function(){return{}},login:function(){return{}},getVersion:function(){return{}}}}()}.call(this);
//# sourceMappingURL=api4game.js.map
