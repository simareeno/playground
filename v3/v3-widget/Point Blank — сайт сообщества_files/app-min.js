(function(t,e){"function"==typeof define&&define.amd?define(["underscore"],e):t.che=e(t._)})(this,function(t){var e,n,r;return function(t){function i(t,e){return _.call(t,e)}function o(t,e){var n,r,i,o,s,u,a,c,l,f,d,h,p=e&&e.split("/"),m=y.map,g=m&&m["*"]||{};if(t){for(t=t.split("/"),s=t.length-1,y.nodeIdCompat&&S.test(t[s])&&(t[s]=t[s].replace(S,"")),"."===t[0].charAt(0)&&p&&(h=p.slice(0,p.length-1),t=h.concat(t)),l=0;t.length>l;l++)if(d=t[l],"."===d)t.splice(l,1),l-=1;else if(".."===d){if(0===l||1===l&&".."===t[2]||".."===t[l-1])continue;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}if((p||g)&&m){for(n=t.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),p)for(f=p.length;f>0;f-=1)if(i=m[p.slice(0,f).join("/")],i&&(i=i[r])){o=i,u=l;break}if(o)break;!a&&g&&g[r]&&(a=g[r],c=l)}!o&&a&&(o=a,u=c),o&&(n.splice(0,u,o),t=n.join("/"))}return t}function s(e,n){return function(){var r=b.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),h.apply(t,r.concat([e,n]))}}function u(t){return function(e){return o(e,t)}}function a(t){return function(e){g[t]=e}}function c(e){if(i(v,e)){var n=v[e];delete v[e],w[e]=!0,d.apply(t,n)}if(!i(g,e)&&!i(w,e))throw Error("No "+e);return g[e]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function f(t){return function(){return y&&y.config&&y.config[t]||{}}}var d,h,p,m,g={},v={},y={},w={},_=Object.prototype.hasOwnProperty,b=[].slice,S=/\.js$/;p=function(t,e){var n,r=l(t),i=r[0];return t=r[1],i&&(i=o(i,e),n=c(i)),i?t=n&&n.normalize?n.normalize(t,u(e)):o(t,e):(t=o(t,e),r=l(t),i=r[0],t=r[1],i&&(n=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:n}},m={require:function(t){return s(t)},exports:function(t){var e=g[t];return e!==void 0?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},d=function(e,n,r,o){var u,l,f,d,h,y,_=[],b=typeof r;if(o=o||e,"undefined"===b||"function"===b){for(n=!n.length&&r.length?["require","exports","module"]:n,h=0;n.length>h;h+=1)if(d=p(n[h],o),l=d.f,"require"===l)_[h]=m.require(e);else if("exports"===l)_[h]=m.exports(e),y=!0;else if("module"===l)u=_[h]=m.module(e);else if(i(g,l)||i(v,l)||i(w,l))_[h]=c(l);else{if(!d.p)throw Error(e+" missing "+l);d.p.load(d.n,s(o,!0),a(l),{}),_[h]=g[l]}f=r?r.apply(g[e],_):void 0,e&&(u&&u.exports!==t&&u.exports!==g[e]?g[e]=u.exports:f===t&&y||(g[e]=f))}else e&&(g[e]=r)},e=n=h=function(e,n,r,i,o){if("string"==typeof e)return m[e]?m[e](n):c(p(e,n).f);if(!e.splice){if(y=e,y.deps&&h(y.deps,y.callback),!n)return;n.splice?(e=n,n=r,r=null):e=t}return n=n||function(){},"function"==typeof r&&(r=i,i=o),i?d(t,e,n,r):setTimeout(function(){d(t,e,n,r)},4),h},h.config=function(t){return h(t)},e._defined=g,r=function(t,e,n){if("string"!=typeof t)throw Error("See almond README: incorrect module build, no module name");e.splice||(n=e,e=[]),i(g,t)||i(v,t)||(v[t]=[t,e,n])},r.amd={jQuery:!0}}(),r("almond",function(){}),function(){r("events",["underscore"],function(t){var e,n;return n=function(t){return this.name=t,this._handlers={},this},n.prototype={_data:function(){return{name:this.name}},_handlerCaller:function(t,e){var n,r,i,o,s;if(t.contexts.length){for(o=t.contexts,s=[],r=0,i=o.length;i>r;r++)n=o[r],s.push(t.apply(n,e));return s}return t.apply(null,e)},_nextHandlerCall:function(e){var n,r;return r=this._handlersCallOrder.shift(),r?(n=this._handlers[r],n.options.isSync?this._handlerCaller(n,e):t.delay(function(t){return function(){return t._handlerCaller(n,e)}}(this),1),this._nextHandlerCall(e)):void 0},dispatch:function(e){return e=t.isArray(e)?e:[e],this._handlersCallOrder=t.keys(this._handlers).sort(),e.push(this._data()),this._lastArgs=e,this._nextHandlerCall(e),this},bind:function(e,n,r){return e.id=e.id||+t.uniqueId(),e.contexts=e.contexts||[],null==n||t.find(e.contexts,function(t){return t===n})||e.contexts.push(n),e.options=e.options||r||{},this._handlers[e.id]=e,e.options.recall&&this._lastArgs&&this._handlerCaller(e),this},once:function(t,e,n){var r,i;return i=this,r=function(){return i.unbind(r),t.apply(this,arguments)},this.bind(r,e,n),this},unbind:function(e,n){var r;return r=e.id,r&&this._handlers[r]&&(null!=n?(e.contexts=t.filter(e.contexts,function(t){return t!==n}),e.contexts.length||delete this._handlers[r]):delete this._handlers[r]),this}},window.evnts=[],e=function(t){return this._id=t,this.list={},this},e.prototype={sprout:function(t){var n;return n=new e,null!=t&&(this[t]=n),n},create:function(t){return this.list[t]=this.list[t]||new n(t)},createList:function(t,e){var n,r,i,o,s,u,a;if(i=t.split("@"),o=i[0],n=[],n[o]=this.create(o),!e&&i.length>1)for(r=u=1,a=i.length-1;a>=1?a>=u:u>=a;r=a>=1?++u:--u)s=""+o+"@"+i[r],n[s]=this.create(s);return n},once:function(t,e,n,r){return this.create(t).once(e,n,r)},bind:function(e,n,r,i){var o,s,u,a,c,l,f,d;for(o=t.compact(e.split(/\,+\s*|\s+/)),/\,+/.test(e)?(s={},c=o.concat([]),u=function(){var e;return e=t.last(arguments),s[e.name]=arguments,t.contains(c,e.name)&&(c=t.without(c,e.name)),0===c.length?(c=o.concat([]),n.call(this,s)):void 0}):u=n,l=function(t){return function(e){return t.create(e).bind(u,r,i)}}(this),f=0,d=o.length;d>f;f++)a=o[f],l(a);return this.create(o[0])},unbind:function(t,e,n){var r,i,o,s,u,a,c;if(i=t.split("@"),o=i[0],this.list[o]&&this.list[o].unbind(e,n),i.length>1){for(c=[],r=u=1,a=i.length-1;a>=1?a>=u:u>=a;r=a>=1?++u:--u)s=""+o+"@"+i[r],this.list[s]?c.push(this.list[s].unbind(e,n)):c.push(void 0);return c}},trigger:function(t,e){var n,r,i,o;i=this.createList(t),o=[];for(r in i)n=i[r],o.push(n.dispatch(e));return o}},new e("root")})}.call(this),function(){r("utils/popups",["underscore","events"],function(t,e){var n,r,i,o,s,u,a,c,l,f,d;return l=null,f=!1,u=null,s=null,i=function(t){return console.log("show!",t)},r=function(t){return console.log("hide!",t)},c=function(t){return l=t,"function"==typeof u?u(l):i(l)},o=function(){return l?"function"==typeof s?s(l):r(l):!1},a=function(){return console.log("remove!",l),l=null},n=function(){return e.bind("section-popup:inserted",c),e.bind("section-popup:removed",a),f=!0},d=function(){return e.unbind("section-popup:inserted",c),e.unbind("section-popup:removed",a),f=!1},n(),{on:function(){return n()},off:function(){return d()},getCurrentPopup:function(){return l},isTurnedOn:function(){return f},registerShowHideFunc:function(t,e){return t&&e?(u=t,s=e):!1},unregisterShowHideFunc:function(){return u=null,s=null}}})}.call(this),function(){r("utils/preprocessors/scroll",["events"],function(t){var e,n;return n=[],e=function(t){var e,r,i,o;for(r=i=0,o=n.length;o>i;r=++i)if(e=n[r],e===t)return r},{_handlers:n,process:function(e){var r,i,o,s,u,a;if(o=(null!=(a=e.state)?a.scrollPos:void 0)||{},t.trigger("scrollHandlers:prepare",e),null!=e.state&&!e.state.userReplaceState&&!e.next_transition){for(s=0,u=n.length;u>s;s++)r=n[s],i=r(o,e)||{},null!=i.top&&(o.top=i.top),null!=i.left&&(o.left=i.left);e.state.scrollPos=o}return o},register:function(t){return"function"==typeof t&&null==e(t)?n.push(t):void 0},unregister:function(t){var r;return r=e(t),null!=r?n.splice(r,1):void 0}}})}.call(this),function(){r("utils/preprocessors/clicks",[],function(){var t,e;return t=[],e=function(e){var n,r,i,o;for(r=i=0,o=t.length;o>i;r=++i)if(n=t[r],n===e)return r},{_handlers:t,process:function(e){var n,r,i;for(r=0,i=t.length;i>r;r++)if(n=t[r],n(e)===!1)return!1},register:function(n){return"function"==typeof n&&null==e(n)?t.push(n):void 0},unregister:function(n){var r;return r=e(n),null!=r?t.splice(r,1):void 0}}})}.call(this),function(){r("config",["utils/popups","utils/preprocessors/scroll","utils/preprocessors/clicks"],function(t,e,n){return{widgetDataAttributeName:"data-js-widgets",widgetCssAttributeName:"data-css-widgets",reloadParamsDataAttributeName:"data-reload-params",reloadSectionsDataAttributeName:"data-reload-sections",baseWidgetsPath:"",noFirstTransition:!1,sectionTagName:"section",autoScrollOnTransitions:!0,sectionSelectorAttributeName:"data-selector",storage:["fake","localStorage","cookies"],_modules:{popups:t,scroll:e,clicks:n},redirectDefaultRuleName:"common",redirectRules:{common:null},setup:function(t){var e,n;for(e in t)n=t[e],this[e]=n;return this}}})}.call(this),function(){r("utils/errorHandlers/errorHandler",[],function(){var t,e,n;return t=[],e=function(e){return t.push(e)},n=function(e,n){var r,i,o,s;for(null==n&&(n=[]),s=[],i=0,o=t.length;o>i;i++)r=t[i],void 0!==r[e]&&s.push(r[e](n));return s},{addErrorHandler:e,processError:n}})}.call(this),function(){r("utils/errorHandlers/console",[],function(){return{sectionLoadError:function(t){return console.error("SECTION LOAD ERROR: ",t.state,t.errorCode,t.errorMessage)}}})}.call(this),function(){r("history",["events"],function(t){var e,n,r,i,o,s,u,a;return window.history&&window.history.pushState?(e=function(){function t(t){null==t&&(t={}),this.che=!0,this.url=t.url||window.location.href,this.index=t.index||0,this.method=t.method||"GET",this.sections=t.sections,this.sectionsHeader=t.sectionsHeader||[],this.sectionsParams=t.sectionsParams||{},this.scrollPos={},t.replaceState&&(this.userReplaceState=!0),this.updateScroll(t)}return t.prototype.getScroll=function(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}},t.prototype.updateScroll=function(t){var e;return null==t&&(t={}),e=this.getScroll(),null==t.scrollPos&&(t.scrollPos={}),this.scrollPos={top:t.scrollPos.top||e.top,left:t.scrollPos.left||e.left}},t}(),r=window.location.href,window.history.CheState=e,n=!1,a=!1,o=window.onpopstate,window.onpopstate=function(e){var i;return i=!a&&location.href===r,a=!0,i?void 0:(null!=o&&o.apply(window,arguments),"state"in e?null!=e.state?(e.state.che&&(n=!0),t.trigger("history:popState",e.state)):(n=!0,t.trigger("history:popState")):void 0)},i=window.onhashchange,window.onhashchange=function(){return null!=i&&i.apply(window,arguments),n||t.trigger("history:popState"),n=!1},s=window.history.pushState,window.history.pushState=function(){return a=!0,s.apply(window.history,arguments),t.trigger("history:pushState",Array.prototype.slice.call(arguments))},u=window.history.replaceState,window.history.replaceState=function(){return u.apply(window.history,arguments),t.trigger("history:replaceState",Array.prototype.slice.call(Array,arguments))},window.history):!1})}.call(this),function(){r("utils/params",["underscore"],function(t){var e,n,r;return n=/[?&]([^=]+)\=([^&]+)/g,e=function(n,r,i){var o,s,u,a;if(i=i||[],t.isString(n))i.push((r||"")+("="+encodeURIComponent(n)));else for(o in n)a=n[o],s=null!=r?r+encodeURIComponent("["+o+"]"):encodeURIComponent(o),u=("function"==typeof a?a():void 0)||a,e(u,s,i);return i},r=function(t){var e,r;for(r={};e=n.exec(t);)e!==void 0&&null!==e&&(r[e[1]]=e[2]);return r},function(n,i){return t.isFunction(n)?e(n()).join("&"):t.isObject(n)?e(n).join("&"):"string"==typeof n&&i?r(n):null!=n?""+n:void 0}})}.call(this),function(){r("utils/destroyer",["underscore"],function(t){var e;return e=function(n,r){return t.each(n,function(i,o){return n.hasOwnProperty(o)?(r&&t.isObject(i)&&t.delay(e,i),delete n[o]):void 0})}})}.call(this),function(){r("ajax",["events","utils/params","utils/destroyer","underscore"],function(t,e,n,r){var i,o,s,u,a,c,l,f,d,h,p,m;for(u=function(t,n){var i,o;return o=t.split("?"),i=null==n||r.isEmpty(n)?o[1]?"?"+o[1]:"":"?"+e(n),""+o[0]+i},d=function(t,n,r,i,o,s){var u,c,l;if(l=a(),!l)return!1;if(""===t&&(t=document.location.href),l.open(i,t,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!=s)for(u in s)c=s[u],l.setRequestHeader(u,c);return null!=n&&(n=e(n),l.setRequestHeader("Content-type","application/x-www-form-urlencoded")),l.onreadystatechange=function(){return 4===l.readyState&&0!==l.status?200!==l.status&&304!==l.status?(o.trigger("error",[l,null]),o.trigger("complete",[l,null]),void 0):(n=null!=l.responseText?(f[r]||f.json)(l.responseText):"",o.trigger("success",[l,n]),o.trigger("complete",[l,n])):void 0},4===l.readyState?(n=null!=l.responseText?(f[r]||f.json)(l.responseText):"",o.trigger("complete",[l,n]),l):(o.trigger("start",[l]),l.send(n),l)},o=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],a=function(){var t,e,n,r,i;for(e=!1,r=0,i=o.length;i>r;r++){n=o[r];try{e=n(),a=function(){return n()}}catch(s){t=s;continue}break}return e},f={json:function(t){return console.log(t),JSON.parse(t)},text:function(t){return t},"default":function(t){return t}},c={type:"json",method:"GET"},i=function(t){return null!=t&&this.get(t),this},i.prototype={get:function(e){var i,o,s,u;if(this._events&&n(this._events),null!=e.url){for(this._events=t.sprout(),u=["start","success","error","complete"],o=0,s=u.length;s>o;o++)i=u[o],r.isFunction(e[i])&&this._events.bind(i,e[i],{},{recall:!0,isSync:!0});this._request=d(e.url,e.data||{},e.type||"",e.method||c.method,this._events,e.headers)}return this},abort:function(){return this._request.abort(),this}},m=["start","success","error","complete"],h=0,p=m.length;p>h;h++)l=m[h],i.prototype[l]=function(t){return this._events.bind(l,t,{recall:!0})};return s=function(t){return new i(t)},s.get=function(t){return t.method="GET",null!=t.url&&(t.url=u(t.url,t.data)),new i(t)},s.post=function(t){return t.method="POST",new i(t)},s.dispatch=function(t){return null!=t.method&&"post"===t.method.toLowerCase()?s.post(t):s.get(t)},s})}.call(this),function(){r("utils/guid",[],function(){var t;return t=function(){return Math.floor(65536*Math.random()).toString(16)},function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}})}.call(this),r("lib/domReady",[],function(){function t(t){var e;for(e=0;t.length>e;e+=1)t[e](c)}function e(){var e=l;a&&e.length&&(l=[],t(e))}function n(){a||(a=!0,s&&clearInterval(s),e())}function r(t){return a?t(c):l.push(t),r}var i,o,s,u="undefined"!=typeof window&&window.document,a=!u,c=u?document:null,l=[];if(u){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{i=null===window.frameElement}catch(f){}o.doScroll&&i&&window.external&&(s=setInterval(function(){try{o.doScroll(),n()}catch(t){}},30))}("complete"===document.readyState||"interactive"===document.readyState)&&n()}return r.version="2.0.1",r.load=function(t,e,n,i){i.isBuild?n(null):r(n)},r}),function(){r("dom",["utils/guid","lib/domReady","underscore"],function(t,e,n){var r,i,o,s,u,a,c,l,f,d;return o=function(t,e,r){var i,s,a,c;if(e===r||!e)return!1;for(r=r||document,i=n.isString(t)?u(r).find(t).get():t,a=0,c=i.length;c>a;a++)if(s=i[a],s===e)return s;return o(i,e.parentNode,r)},i=function(t,e,n){var r,i,o,s,u;for(o=n,s=0,u=t.length;u>s;s++)if(r=t[s],i=r.call(n,e,o),i===!1)return!1},l=function(t,e){var r;return window.jQuery?(l=function(t,e){return window.jQuery(e||document).find(t).get()},l.apply(this,arguments)):null!=document.querySelectorAll?n.isString(t)?(e=e&&0!==e.length?e:document,e.length||(e=[e]),r=[],n.each(e,function(e){return null!=e.querySelectorAll?r=r.concat(Array.prototype.slice.call(e.querySelectorAll(t))):void 0}),r):t:"undefined"!=typeof console&&null!==console?console.log("haven't tools for selecting node (module helpers/dom)"):void 0},f=function(t){if(t.removeEventListener)f=function(t,e,n){return t.removeEventListener(e,n,!1)};else{if(!t.detachEvent)return"undefined"!=typeof console&&null!==console?console.log("cannot unbind event (module helpers/dom)"):void 0;f=function(t,e,n){return t.detachEvent("on"+e,n)}}return f.apply(this,arguments)},r=function(t){if(t.addEventListener)r=function(t,e,n){return t.addEventListener(e,n,!1)};else{if(!t.attachEvent)return"undefined"!=typeof console&&null!==console?console.log("cannot bind event (module helpers/dom)"):void 0;r=function(t,e,n){return t.attachEvent("on"+e,n)}}return r.apply(this,arguments)},s=function(e,s,u,a){var c;return e.domQueryDelegateHandler||(c=function(t){var r,s,u,a;return r=t||window.event,a=r.target||r.srcElement,3===a.nodeType&&(a=a.parentNode),e.domQueryHandlers[r.type]?(s=e.domQueryHandlers[r.type],u=!0,n.each(s,function(t,n){var s;return s=o(n,a,e),s?u=i(t,r,s):void 0}),u):void 0},e.domQueryDelegateHandler=c),r(e,u,e.domQueryDelegateHandler),a.guid=a.guid||t(),e.domQueryHandlers=e.domQueryHandlers||{},e.domQueryHandlers[u]=e.domQueryHandlers[u]||{},e.domQueryHandlers[u][s]=e.domQueryHandlers[u][s]||[],e.domQueryHandlers[u][s].push(a)},d=function(t,e,r,i){var o,s;return t.domQueryHandlers?t.domQueryHandlers[r]?t.domQueryHandlers[r][e]?(o=t.domQueryHandlers[r][e],s=null,n.find(o,function(t,e){var n;return n=t.original?t.original.guid:t.guid,s=e,n===i.guid}),null!==s?(o.splice(s,1),t.domQueryHandlers[r][e]=o):void 0):!1:!1:!1},a=function(t){var e;return e=document.createElement("DIV"),e.appendChild(t),e.innerHTML},c=function(t){var e,n,r,i,o;for(e=document.createElement("DIV"),e.innerHTML=t,o=Array.prototype.slice.call(e.childNodes),r=0,i=o.length;i>r;r++)n=o[r],3!==n.nodeType||/\S/.test(n.nodeValue)||e.removeChild(n);return e.childNodes},u=function(t){var e;return this instanceof u?t instanceof u?t:(n.isString(t)?(t=t.replace(/^\s+|\s+$/g,""),e="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?c(t):l(t)):e=t||[document],null!=e.elements?(this.length=1,this.selector=t,this[0]=t,void 0):((void 0===e.length||3===e.nodeType)&&(e=[e]),this.length=e.length,this.selector=t,n.each(e,function(t){return function(e,n){return t[n]=e}}(this)),void 0)):new u(t)},u.prototype={on:function(e,i){var o,u,a,c,l;return o=2,a=s,n.isFunction(i)&&(a=r,o--),c=l=arguments[o],null!=arguments[o+1]&&(l.guid=l.guid||t(),c=n.bind(l,arguments[o+1]),c.original=l),u=Array.prototype.slice.call(arguments),u[o]=c,n.each(this.get(),function(t){return a.apply(this,[t].concat(u))}),this},off:function(){var t,e;return e=3===arguments.length?d:f,t=Array.prototype.slice.call(arguments),n.each(this.get(),function(n){return e.apply(this,[n].concat(t))}),this},find:function(t){return u(l(t,this.get()))},get:function(t){return null!=t?(t=Math.max(0,Math.min(t,this.length-1)),this[t]):Array.prototype.slice.call(this)},toString:function(){return n.map(this.get(),function(t){return a(t)}).join("")},replaceWith:function(t){return this[0]=this[0].parentNode.replaceChild(t[0]||t,this[0])}},u})}.call(this),function(){r("lib/async",["underscore"],function(t){var e,n,r,i;return e=function(t){return this._start_time=+new Date,this._limit=t||50},e.prototype={start:function(e){var n;return n=+new Date,this._limit<n-this._start_time?(this._start_time=n,t.delay(e)):e()}},i={call_complete_handlers:function(t,e,n){var r;return t.length>0?(r=t.shift(),r(e),n.start(function(){return i.call_complete_handlers(t,e,n)})):void 0}},r=function(n,r,o){var s,u,a,c,l,f,d;return f=void 0,l=null,s=r||new e,d={is_complete:!1},u=[],t.isFunction(o)&&u.push(o),c=function(){return d.is_complete=!0,d.result||(d.result=d.data),i.call_complete_handlers(u,d,s)},a=t.isFunction(n)?function(){var e,r;return d.is_wait?!1:d.is_complete||0===f.length?c():(e=f.shift(),r=n(d.data[e],e,l),void 0!==r&&(d.result||(d.result=t.isArray(d.data)?[]:{}),d.result[e]=r),s.start(a))}:function(){return d.is_complete=!0,d.result=d.data,c(),d},l=function(e){return d.data=e,f=t.isArray(e)||t.isObject(e)?t.keys(d.data):[],s.start(a)},l.iterator=n,l.complete=function(t){return u.push(t),d.is_complete?c():void 0},l.stop=function(){return f=[],d.is_complete=!0},l.pause=function(){return d.is_wait=!0},l.resume=function(){return d.is_wait=!1,null!=s?s.start(a):void 0},l.state=d,l},n=function(n){return this._last_iteration=r(),this._last_iteration(n||[]),this._balancer=new e,this._id=t.uniqueId(),this._current_iteration=this._last_iteration,this},n.prototype={_push:function(t){var e,n;return e=r(t.iterator,this._balancer,t.complete),n=this._last_iteration,this._last_iteration=e,n.complete(function(t){return function(n){return t._current_iteration=e,e(n.result)}}(this)),this},stop:function(){return this._current_iteration.stop(),this},use:function(t){return this._push({complete:function(e){return e.result=t}}),this},each:function(t){return this._push({iterator:function(e,n,r){return t(e,n,r)===!1?this.stop():void 0}}),this},map:function(t){return this._push({iterator:t})},reduce:function(t){var e;return e=void 0,this._push({iterator:function(n,r,i){return e=t(n,r,e,i)},complete:function(t){return t.result=e}}),this},find:function(t){var e;return e=void 0,this._push({iterator:function(n,r,i){return t(n,r,i)?e=n:void 0},complete:function(t){return t.result=e}}),this},next:function(e){return this._push({complete:function(n){var r;return r=e(n.result),n.result=t.isUndefined(r)?n.data:r}}),this}},function(t){return new n(t)}})}.call(this),function(){r("sections/asyncQueue",["lib/async"],function(t){var e;return e=t(),e.name="sectionsAsyncQueue",e})}.call(this),function(){r("widgets",["events","dom","utils/destroyer","config","utils/guid","underscore"],function(t,e,n,r,i,o){var s,u,a,c,l,f,d,h,p,m,g;return m={},f=[],l=/^(\S+)\s*(.*)$/,c={},u=function(t,n){var r;return r=e(n.element),o.each(t,function(e,i){var s,u,a,f,d;return d=i.split(l),a=d[1],f=d[2],s=null,o.isString(e)?(u=c[e]=n[e],s=n):u=e,t[i]=e,"@element"===f?r.on(a,u,s):r.on(f,a,u,s)})},d=function(t,n){var r;return r=e(n.element),o.each(t,function(t,e){var n,i,o;return o=e.split(l),n=o[1],i=o[2],null!=c[t]&&(t=c[t]),"@element"===i?r.off(n,t):r.off(i,n,t)})},a=function(e,n){return o.each(e,function(r,i){var s;return null!=r.handler&&(s=o.omit(r,"handler"),r=r.handler),r=o.isString(r)?n[r]:r,t.bind(i,r,n,s),e[i]=r})},h=function(e,n){return o.each(e,function(e,r){return t.unbind(r,e,n)})},p={_instances:{},_id_attr:function(t){return("data-"+t+"-id").replace(/[\/?=&!]/g,"-")},remove:function(t){return t.element.removeAttribute(this._id_attr(t.name)),delete this._instances[t.id],n(t)},get:function(t,e){var n;return n=this._id_attr(t),this._instances[e.getAttribute(n)]},add:function(t,e,n){var r,i;return i=this.get(t,e),null!=i?(i.wakeUp(),i):(r=new s(t,e,n),r.element.setAttribute(this._id_attr(t),r.id),this._instances[r.id]=r,r)}},s=function(t,e,n){return this.name=t,this.element=e,o.extend(this,n),this.id=i(),"function"==typeof this.init&&this.init(this.element),null!=this.switchEvents&&f.push(this),this.wakeUp(),this.isInitialized=!0},s.prototype={wakeUp:function(){return this._isOn?void 0:(u(this.domEvents,this),a(this.moduleEvents,this),"function"==typeof this.turnOn&&this.turnOn(),this._isOn=!0,this)},sleepDown:function(){return this._isOn?(d(this.domEvents,this),h(this.moduleEvents,this),"function"==typeof this.turnOff&&this.turnOff(),this._isOn=!1,this):void 0},destroy:function(){var t,e,n,r;for(this.sleepDown(),t=n=0,r=f.length;r>n;t=++n)if(e=f[t],e=this){f.splice(t,1);break}return p.remove(this)}},g={_manager:p,_constructor:s,_switchManagers:f,get:function(t,e){return t=r.baseWidgetsPath+t,p.get(t,e)},create:function(t,e,n){return/^http/.test(t)||(t=r.baseWidgetsPath+t),"function"==typeof window.require?window.require([t],function(r){var i;return i=p.add(t,e,r),"function"==typeof n?n(i):void 0}):void 0}}})}.call(this),function(){r("utils/widgetsData",["dom","config"],function(t,e){var n,r;return r=function(t,n){var r,i,o,s,u;if(i=null,n&&null!=n.getAttribute&&(i=null!=(u=n.getAttribute(e.widgetDataAttributeName))?u.replace(/^\s|\s$/,"").split(/\s*,\s*/):void 0),!i)return!1;for(o=0,s=i.length;s>o;o++)r=i[o],t.push({name:r,element:n});return t},n=function(n){var i,o,s,u,a,c,l,f,d;if(o=[],n&&n!==document)for(s=t(n),c=0,f=s.length;f>c;c++)u=s[c],r(o,u);else s=t(document);for(a=s.find("["+e.widgetDataAttributeName+"]").get(),l=0,d=a.length;d>l;l++)i=a[l],r(o,i);return o}})}.call(this),function(){r("loader",["widgets","config","events","lib/domReady","utils/widgetsData","underscore"],function(t,e,n,r,i,o){var s;return s={widgets:function(e,n){var r,i,s,u,a,c;if(s=o.keys(e).length,i=[],0===s)return"function"==typeof n?n(i):void 0;for(c=[],u=0,a=e.length;a>u;u++)r=e[u],c.push(t.create(r.name,r.element,function(t){return i.push(t),s-=1,0===s?"function"==typeof n?n(i,e):void 0:void 0}));return c},search:function(t,e){return s.widgets(i(t),e)}},r(function(){return s.search()}),s})}.call(this),r("lib/serialize",[],function(){return function(t){if(t&&"FORM"===t.nodeName){var e,n,r=[];for(e=t.elements.length-1;e>=0;e-=1)if(""!==t.elements[e].name&&!t.elements[e].disabled)switch(t.elements[e].nodeName){case"INPUT":switch(t.elements[e].type){case"text":case"email":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"range":case"search":case"tel":case"time":case"url":case"week":case"hidden":case"password":case"button":case"reset":case"submit":r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].value));break;case"checkbox":case"radio":t.elements[e].checked&&r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].value));break;case"file":}break;case"TEXTAREA":r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].value));break;case"SELECT":switch(t.elements[e].type){case"select-one":r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].value));break;case"select-multiple":for(n=t.elements[e].options.length-1;n>=0;n-=1)t.elements[e].options[n].selected&&r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].options[n].value))}break;case"BUTTON":switch(t.elements[e].type){case"reset":case"submit":case"button":r.push(t.elements[e].name+"="+encodeURIComponent(t.elements[e].value))}}return r.join("&")}}}),function(){r("clicks/forms",["dom","config","events","lib/domReady","lib/serialize","utils/preprocessors/clicks"],function(t,e,n,r,i,o){var s,u,a,c;return s=null,r(function(){return t("body").on("form["+e.reloadSectionsDataAttributeName+"]","submit",function(t){var e,n;if(null==s)return!0;if("reset"===this.type||"button"===this.type)return!0;for(e=this;!n;)if("form"===e.nodeName.toLowerCase())n=!0;else{if(e===document)return!0;e=e.parentNode}return a(e,t)})}),c=function(n){var r,i,o,s,u;for(n=t(null!=n?n:"body"),i=n.find("form["+e.reloadSectionsDataAttributeName+"]").get(),u=[],o=0,s=i.length;s>o;o++)r=i[o],u.push(r.onsubmit=function(t){return a(t.target,t)});return u},a=function(t,n){var r,u,a,c,l,f;return r=t.getAttribute(e.reloadSectionsDataAttributeName),l=t.getAttribute(e.reloadParamsDataAttributeName),f=t.getAttribute("action")||"",a=i(t),c=t.getAttribute("method")||"GET",u={url:f,data:r,params:l,method:c,formData:a},o.process(u)===!1?!0:(s.trigger("form:click",u),n.preventDefault(),!1)},u=function(t){return null==s&&(s=n.sprout()),s.bind("form:click",t)},u.reset=function(){return s=null},u.processForms=function(t){return c(t)},u})}.call(this),function(){r("sections/section",["events","config","loader","widgets","utils/widgetsData","underscore","clicks/forms","dom"],function(t,e,n,r,i,o,s,u){var a,c;return c=/\.css$/,a=function(){return this.name,this.params={},this.element,this.getSectionHtml=function(){return this.sectionHtml||(this.sectionHtml=null!=this.element&&null!=this.element.childNodes?Array.prototype.slice.call(this.element.childNodes):[]),this.sectionHtml},this},a.prototype={turnOn:function(t,e){return this.loadStyles(function(n){return function(){return"function"==typeof t&&t(),n.turnOnWidgets(),n.insertIntoDOM(),n.onInsert(),"function"==typeof e&&e(),u(n.getSectionHtml())}}(this))},loadStyles:function(t){var n,r,i,o,s,a,l,f,d,h;for(r=[],s=u("head")[0],o=null!=(d=window.require)?d.specified("css"):void 0,h=u(this.getSectionHtml()).find("["+e.widgetCssAttributeName+"]").get(),l=0,f=h.length;f>l;l++)i=h[l],null!=i.getAttribute&&(n=i.getAttribute(e.widgetCssAttributeName),null!=n&&(n=""+n.replace(c,"")+".css"),o||(a=document.createElement("link"),a.rel="stylesheet",a.type="text/css",a.href=n,s.appendChild(a)),r.push("css!"+n));return r.length?o?window.require(r,function(){return setTimeout(t,100)}):(console.warn("External plugin for loading css is not found. Creating direct links..."),"function"==typeof t?t():void 0):"function"==typeof t?t():void 0},turnOff:function(){return this.turnOffWidgets(),this.removeFromDOM(),this.onRemove()},removeFromDOM:function(){var t,e,n,r,i;for(r=this.getSectionHtml(),i=[],e=0,n=r.length;n>e;e++)t=r[e],null!=t.parentNode?i.push(t.parentNode.removeChild(t)):i.push(void 0);return i},insertIntoDOM:function(){var t,n,r,i,o,s,a,c;if(this.params.target)switch(this.params.target){case"icon":if(!this.element.href)return;try{if(r=document.createElement("link"),r.setAttribute("type","image/ico"),r.setAttribute("rel","shortcut icon"),r.setAttribute("href",this.element.href),i=u('link[rel="shortcut icon"]')[0],null!=i)return i.parentNode.replaceChild(r,i)}catch(l){}break;default:if(t=u(this.params.target)[0],null==t)return;for(t.setAttribute(e.sectionSelectorAttributeName,""+this.name+": "+JSON.stringify(this.params)),a=this.getSectionHtml(),c=[],o=0,s=a.length;s>o;o++)n=a[o],c.push(t.appendChild(n));return c}},turnOnWidgets:function(){return n.search(this.getSectionHtml())},turnOffWidgets:function(){var t,e,n,o,s,u;for(o=i(this.getSectionHtml()),u=[],e=0,n=o.length;n>e;e++)t=o[e],u.push(null!=(s=r.get(t.name,t.element))?s.sleepDown():void 0);return u},onInsert:function(){var t;return t="inserted",this.notifyAll(t),this.processNamespaces(t)},onRemove:function(){var t;return t="removed",this.notifyAll(t),this.processNamespaces(t)},processNamespaces:function(t){var e,n,r,i,s;if(null!=this.params.ns){for(o.isString(this.params.ns)&&(this.params.ns=[this.params.ns]),i=this.params.ns,s=[],n=0,r=i.length;r>n;n++)e=i[n],s.push(this.notifyAll(t,"-"+e));return s}},notifyAll:function(e,n,r){var i;if(e)return i=[this],null!=r&&i.push(r),t.trigger("section"+n+":"+e,i)}},a})}.call(this),function(){r("sections/parser",["sections/asyncQueue","sections/section","dom","config"],function(t,e,n,r){return{parseSections:function(t){var i,o,s,u,a,c,l,f;for(s=[],u=n(t),f=u.get(),c=0,l=f.length;l>c;c++)i=f[c],o=i.nodeName.toLowerCase(),a=new e,a.element=i,o===r.sectionTagName?this.parseSectionParams(a,i.getAttribute(r.sectionSelectorAttributeName)):"title"===o?(a.name=o,a.params.target=o):"link"===o&&"shortcut icon"===i.rel&&(a.params.target="icon",a.params.ns=["icon"]),s.push(a);return s},parseSectionParams:function(t,e){var n,r;if(r=/([^:]+):\s*(.+)/.exec(e)){t.name=r[1];try{return t.params=JSON.parse(r[2])}catch(i){return n=i,t.params={target:r[2]}}}}}})}.call(this),function(){r("sections/invoker",["sections/asyncQueue","sections/parser","sections/section","dom","events","loader","config","utils/widgetsData","widgets","underscore"],function(t,e,n,r,i,o,s,u,a,c){var l;return l=function(t,e){return this.reloadSections=t,this.state=e,this._back=null,this._forward=null,this._is_applied=!1,this._is_sections_updated=!1},l.prototype={initializeSections:function(){return this._is_sections_updated&&this._forward&&this._back?void 0:(t.next(function(t){return function(){var i,o,u,a,c,l,f,d,h;for(t._isCompressed=!1,r("title")[0]||r("head")[0].appendChild(document.createElement("title")),t._back={},t._forward={},d=t.reloadSections,h=[],l=0,f=d.length;f>l;l++)if(a=d[l],null!=a.params.target){switch(c=a.params.target,i=new n,i.name=a.name,i.params.target=c,c){case"icon":if(u=r('link[rel="shortcut icon"]')[0],(null!=u?u.href:void 0)===a.element.href)continue;i.element=u,i.params.ns=["icon"];break;default:if(o=r(c)[0],null==o)continue;i.element=o,e.parseSectionParams(i,o.getAttribute(s.sectionSelectorAttributeName))}t._forward[c]=a,h.push(t._back[c]=i)}return h}}(this)),this._is_sections_updated=!0)},update:function(t){return this.reloadSections=t,this._is_sections_updated=!1},run:function(){return this._is_applied&&this.undo(),this.initializeSections(),t.next(function(t){return function(){return{back:t._back,forward:t._forward}}}(this)),this._insertSections(),this._is_applied=!0},undo:function(){return this._is_applied!==!0?!1:(t.next(function(t){return function(){return{forward:t._back,back:t._forward}
}}(this)),this._insertSections(),this._is_applied=!1)},_insertSections:function(){var e;return e=this.state,t.next(function(t){var e,n,r,i,o;for(e={},o=c.keys(t.back),r=0,i=o.length;i>r;r++)n=o[r],e[n]={back:t.back[n],forward:t.forward[n]};return e}).each(function(t,e,n){return n.pause(),t.forward.turnOn(function(){return t.back.turnOff()},n.resume)}).next(function(){return i.trigger("sections:inserted",e)})}},l})}.call(this),function(){r("utils/sections",["sections/parser","sections/invoker"],function(t,e){var r,i;return r=document.createElement("a"),r.href="./",i=null,{load:function(t,e){return null==i&&(i=n("sections/loader")),i(r.href,"get",""+t+':{"target":"'+e+'"}',0,null,'{ "loadSectionsSilently": true }')},insert:function(n){var r,i;return i=t.parseSections(n.sections),r=new e(i?i:void 0,n),r.run()}}})}.call(this),function(){r("sections/loader",["ajax","events","dom","underscore","history","config","utils/params","utils/sections"],function(t,e,n,r,i,o,s,u){var a;return a=null,e.bind("history:popState",function(){return null!=a?a.abort():void 0}),function(c,l,f,d,h,p){var m,g,v,y,w;return null==h&&(h=[]),y=arguments.callee,g=function(t,e,n){try{n=JSON.parse(n)}catch(r){}return new i.CheState({url:t,sectionsHeader:f,sectionsParams:n,index:d,method:l,sections:e})},v=function(){var t,r,i;return t=n(f),null!=n(f)[0]?(r=g(c,n(f)[0].innerHTML,p),(null!=(i=r.sectionsParams)?i.loadSectionsSilently:void 0)?u.insert(r):e.trigger("sections:loaded",r)):void 0},w=function(){return null!=a&&a.abort(),a=t.dispatch({url:c,method:l,data:h,headers:{"X-Che":!0,"X-Che-Sections":f,"X-Che-Params":p},type:"text",error:function(t){var n,r;return n=g(c,f,p),(null!=(r=n.sectionsParams)?r.loadSectionsSilently:void 0)?void 0:e.trigger("sections:error",[n,t.status,t.statusText])}}),a.success(function(t,n){var i,a,c,l,f,h,v,w,_;if("function"==typeof t.getResponseHeader){if(t.getResponseHeader("X-Che-Redirect")){if(c=s(t.getResponseHeader("X-Che-Redirect"),!0),i=o.redirectRules[o.redirectDefaultRuleName],l=[],null!=i){r.isArray(i)||(i=[{sectionName:o.redirectDefaultRuleName,params:i}]);for(a in c)w=c[a],h=o.redirectRules[a],h&&l.push({sectionName:w,params:h});return f=m(o.redirectDefaultRuleName,i,l),y(t.getResponseHeader("X-Che-Redirect"),null,f.join(";"),d,null,p)}return window.location.href=t.getResponseHeader("X-Che-Redirect")}return v=g(t.getResponseHeader("X-Che-Url"),n,t.getResponseHeader("X-Che-Params")),(null!=(_=v.sectionsParams)?_.loadSectionsSilently:void 0)?u.insert(v):e.trigger("sections:loaded",v)}})},m=function(t,e,n){var i,o,s,u,a,c,l,f,d,h;if(null==n&&(n=[]),u=[],null!=e&&r.isArray(e)){if(n.length)for(a=0,f=e.length;f>a;a++){for(s=e[a],i=!1,c=0,d=n.length;d>c;c++)if(o=n[c],o.params.target===s.params.target){i=!0;break}i||n.push(s)}else n=e;for(l=0,h=n.length;h>l;l++)o=n[l],u.push(""+o.sectionName+": "+JSON.stringify(o.params));return u}},r.isString(f)&&0>f.indexOf(":")?v():w()}})}.call(this),function(){r("sections/transition",["sections/parser","sections/invoker","sections/asyncQueue","events","utils/destroyer","history","config","utils/preprocessors/scroll"],function(t,e,n,r,i,o,s,u){var a,c,l;return c=5,l=10,a=function(n,r){var i,s,u,a;if(this.state=n,(null!=(a=this.state)?a.che:void 0)||(this.state=new o.CheState(this.state)),this.index=this.state.index=this.state.index||(null!=r?r.index:void 0)+1||0,null!=this.state.sections&&(u=t.parseSections(this.state.sections),this._invoker=new e(u?u:void 0,this.state)),null!=r){for(this.prev_transition=r,r.next_transition=this,r.next(),i=l,s=this;i--&&(s=s.prev_transition,null!=s););null!=s&&s.destroy()}return this},a.prototype={update:function(i){var o,s;return o=!1,this.state.url===i.url?(o=this.state.sections===i.sections,o?void 0:(i.index=this.index,this.state=i,s=t.parseSections(this.state.sections),null!=this._invoker&&null!=s?this._invoker.update(s):null!=s&&(this._invoker=new e(s,this.state)),this.invoke(),n.next(function(){return r.trigger("pageTransition:updated",{})}))):void 0},destroy:function(){return i(this)},next:function(t){var e;return e=this,t!==this.index&&null!=this.next_transition&&(e=this.next_transition,this.next_transition.invoke(),null!=t&&this.next_transition.next(t)),t!==this.index&&t||n.next(function(n){return function(){return n.restoreScroll(e,t),r.trigger("pageTransition:success",{transition:e})}}(this)),this},prev:function(t){var e;return e=this,t!==this.index&&null!=this.prev_transition&&(e=this.prev_transition,this.undo(),null!=t&&this.prev_transition.prev(t)),t!==this.index&&t||n.next(function(n){return function(){return n.restoreScroll(e,t),r.trigger("pageTransition:success",{transition:e})}}(this)),this},undo:function(){var t;return null!=(t=this._invoker)&&t.undo(),r.trigger("transition:undo",this),r.trigger("transition:current:update",this.prev_transition)},invoke:function(){var t;return null!=(t=this._invoker)&&t.run(),r.trigger("transition:invoked",this),r.trigger("transition:current:update",this)},restoreScroll:function(t,e){var n,i;return n=!!s.autoScrollOnTransitions||!!u._handlers.length,i=u.process(t),null!=e&&e!==t.index||!n?void 0:(window.scrollTo(i.left||0,i.top||0),r.trigger("pageTransition:scrolled",t))}},a})}.call(this),function(){r("utils/storage/abstract",[],function(){var t;return t=function(){function t(){this.instance=this.constructor}var e;return t.prototype.save=function(t,n,r,i){var o;return r=JSON.stringify(r),o=e(t,n),this.instance.save(o,r,i)},t.prototype.get=function(t,n){var r,i;return r=e(t,n),i=this.instance.get(r,n),JSON.parse(i)},t.prototype.remove=function(t,n){return this.instance.remove(e(t,n))},t.prototype.getKeys=function(){return this.instance.getKeys},e=function(t,e){return""+t+"/"+e},t}()})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};r("utils/storage/localStorage",["utils/storage/abstract"],function(t){var n;return n=function(t){function n(){return r()?(n.__super__.constructor.apply(this,arguments),void 0):!1}var r,i,o;return e(n,t),i=window.localStorage,o=window.sessionStorage,n.get=function(t){var e;return null!=(e=i.getItem(t))?e:o.getItem(t)},n.save=function(t,e,n){var r,s;s=n?o:i,this.remove(t);try{return s.setItem(t,e),!0}catch(u){return r=u,!1}},n.remove=function(t){return i.removeItem(t),o.removeItem(t),!0},n.getKeys=function(t){var e,n,r,s,u;for(u=t?o:i,n={},e=r=0,s=u.length;s>=0?s>=r:r>=s;e=s>=0?++r:--r)n[u.key(e)]=u.get(u.key(e));return n},r=function(){return i!==void 0},n}(t),new n})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};r("utils/storage/cookieStorage",["utils/storage/abstract"],function(t){var n;return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.get=function(t){return t&&this.hasItemInCookie(t)?unescape(document.cookie.replace(RegExp("(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},n.save=function(t,e,n){var r,i;return!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t)?!1:(i="/",n||(r="; expires=Tue, 19 Jan 2038 03:14:07 GMT"),document.cookie=""+escape(t)+"="+escape(e)+";path="+i+r)},n.remove=function(t){return t&&this.hasItemInCookie(t)?document.cookie=escape(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sPath?"; path="+sPath:""):void 0},n.getKeys=function(){var t,e,n,r,i;for(e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),n={},t=r=0,i=e.length;i>=0?i>=r:r>=i;t=i>=0?++r:--r)n[e(t)]=unescape(getFromCookie(e(t)));return n},n.hasItemInCookie=function(t){return RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},n}(t),new n})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};r("utils/storage/fakeStorage",["utils/storage/abstract"],function(t){var n;return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.get=function(){return null},n.save=function(){return!0},n.remove=function(){return!0},n.getKeys=function(){return{}},n}(t),new n})}.call(this),function(){r("utils/storage/storageFactory",["utils/storage/localStorage","utils/storage/cookieStorage","utils/storage/fakeStorage"],function(t,e,n){var r;return r={getStorage:function(t){var e,r,i,o;for(e=null,i=0,o=t.length;o>i&&(r=t[i],e=this.getStorageByType(r),!e||!e.instance);i++);return e?e:(console.warn("Can not initialize storage"),n)},getStorageByType:function(r){switch(r){case"localStorage":return t;case"cookies":return e;case"fake":return n;default:return!1}}}})}.call(this),function(){r("sections/cache",["config","utils/storage/storageFactory"],function(e,n){var r,i;return i=n.getStorage(e.storage),r={stateId:function(t,e){return""+t+"|header:"+e}},{save:function(e){return t.isString(e.method)&&"post"===e.method.toLowerCase()?!1:i.save("sectionsHistory",r.stateId(e.url,e.header),e)},get:function(t,e){return i.get("sectionsHistory",r.stateId(t,e))},getStorage:function(){return i},setStorage:function(t){return i=t}}})}.call(this),function(){r("sections",["history","events","sections/loader","sections/transition","sections/cache","utils/errorHandlers/errorHandler","dom","widgets"],function(t,e,n,r,i,o,s,u){var a,c;return t?(a=!1,c={last:null,current:null,create:function(e){var n,i,o,s,u,a,l,f;return null==e&&(e={}),e.index=e.index||(null!=(a=this.last)?a.index:void 0)+1||0,n=e.invisible,null==e||e.che||(e=new t.CheState(e)),e.userReplaceState||(null==c.current||c.current.state.userReplaceState||"function"==typeof(u=c.current.state).updateScroll&&u.updateScroll(),e.scrollPos={top:0,left:0}),null!=this.last&&e.index<=this.last.index?(s=this.go(e.index),s.update(e),s):(i=(t.state||{}).url!==e.url,n||(o=i&&!e.userReplaceState?"pushState":"replaceState",t[o](e,e.title,e.url)),this.last=new r(e,(null!=(l=this.current)?null!=(f=l.next_transition)?f.index:void 0:void 0)<e.index?this.current:this.last),this.last)},go:function(t){var e,n;return this.current?t===(null!=(n=this.current)?n.index:void 0)?this.current:(e=t>this.current.index?"next":"prev",this.current[e](t)):this.create()}},e.bind("transition:current:update",function(t){return c.current=t}),e.bind("sections:loaded",function(t){var e,n,r,o,s,l,f,d,h,p;if(o=null!=(h=t.sectionsParams)?h.switchEvent:void 0,n=function(){return i.save(t),c.create(t)},r=!1,s=[],o)for(p=u._switchManagers,f=0,d=p.length;d>f;f++)l=p[f],e=l[l.switchEvents[o]],l._isOn&&"function"==typeof e&&(r=!0,s.push(l.id),a=!0,e.call(l,function(){var t,e,r,i,o;for(o=[],t=r=0,i=s.length;i>r;t=++r){if(e=s[t],l.id===e){s.splice(t,1),s.length||(n(),a=!1);break}o.push(void 0)}return o}));return r?void 0:n()}),e.bind("sections:error",function(t,e,n){return o.processError("sectionLoadError",{state:t,errorCode:e,errorMessage:n})}),e.bind("pageTransition:init",function(t,e,r,o,s){var u,l,f;return a?void 0:(l=i.get(t,e),u=(null!=(f=c.last)?f.index:void 0)+1||0,null!=l&&(l.index=u,c.create(l)),n(t,r,e,u,o,s))}),e.bind("history:popState",function(e){var r,i;if(null!=e){if(c.go(e.index),null!=e.url&&(null!=(r=e.sectionsHeader)?r.length:void 0)&&"post"!==(null!=(i=e.method)?i.toLowerCase():void 0))return n(e.url,e.method,e.sectionsHeader,e.index)}else if(null!=c.last)return c.create(new t.CheState({index:c.last.state.index+1,replaceState:!0}))}),{init:function(t){return e.trigger("transition:current:update",c.create({invisible:t.noFirstTransition}))},_transitions:c}):!1})}.call(this),function(){r("clicks/anchors",["dom","config","events","lib/domReady","utils/preprocessors/clicks"],function(t,e,n,r,i){var o,s;return o=null,r(function(){return t("body").on("a["+e.reloadSectionsDataAttributeName+"],area["+e.reloadSectionsDataAttributeName+"]","click",function(t){var n,r,s,u;return t.ctrlKey||t.altKey||t.shiftKey||t.metaKey?!0:null!=o?(n=this.getAttribute(e.reloadSectionsDataAttributeName),s=this.getAttribute(e.reloadParamsDataAttributeName),u=this.getAttribute("href"),r={url:u,data:n,params:s,method:"GET"},i.process(r)===!1?!0:(o.trigger("anchor:click",r),t.preventDefault(),!1)):void 0})}),s=function(t){return null==o&&(o=n.sprout("anchors")),o.bind("anchor:click",t)},s.reset=function(){return o=null},s})}.call(this),function(){r("clicks",["clicks/forms","clicks/anchors","history","events"],function(t,e,n,r){var i,o;return n?(i=function(t){var e,n,i,o,s,u,a,c,l,f;return s=null!=(u=t.url)?u:null,e=null!=(a=t.data)?a:[],o=null!=(c=t.params)?c:"{}",i=null!=(l=t.method)?l:"GET",n=null!=(f=t.formData)?f:[],r.trigger("pageTransition:init",[s,e,i,n,o])},r.bind("pageTransition:success",function(t){return r.trigger("pageTransition:stop",t)}),o=function(){return t(i),e(i)},o.reset=function(){return t.reset(),e.reset(),o()},o(),o):!1})}.call(this),function(){r("app",["require","config","utils/errorHandlers/errorHandler","utils/errorHandlers/console","sections","clicks","loader","config","events","loader","history","dom","ajax","lib/domReady","clicks","clicks/forms","clicks/anchors","sections/loader","widgets","utils/widgetsData","utils/preprocessors/clicks","utils/preprocessors/scroll"],function(t){var e;return e=function(n){var r,i,o,s,u,a,c,l,f,d;for(i=t("config"),s=t("utils/errorHandlers/errorHandler"),o=t("utils/errorHandlers/console"),n&&i.setup(n),null==n.modules&&(n.modules=[]),d=n.modules,l=0,f=d.length;f>l;l++)a=d[l],null!=i._modules[a]&&(e.module=i._modules[a]);return s.addErrorHandler(o),c=t("sections"),r=t("clicks"),u=t("loader"),c.init(i)},e.config=t("config"),e.events=t("events"),e.loader=t("loader"),e.history=t("history"),e.dom=t("dom"),e.ajax=t("ajax"),e.domReady=t("lib/domReady"),e.clicks=t("clicks"),e.forms=t("clicks/forms"),e.anchors=t("clicks/anchors"),e.sectionsLoader=t("sections/loader"),e.widgets=t("widgets"),e.widgetsData=t("utils/widgetsData"),e.clicksPreprocessor=t("utils/preprocessors/clicks"),e.scrollPreprocessor=t("utils/preprocessors/scroll"),e})}.call(this),function(){r("utils/log",["module"],function(e){var n,r,i,o,s,u,a,c,l,f,d,h,p,m;return i=t.extend({maxEntries:500,logLevel:10},e.config()),n=function(){function t(t,e,n,r){this.message=t,this.namespace=null!=e?e:"global",this.type=n,this.objectsArray=r,this.time=(new Date).getTime()}return t}(),r={entries:[],maxEntries:i.maxEntries,append:function(t,e,r,i){return this.entries.push(new n(t,e,i,r)),this.checkMaxLogStack()},getEntries:function(t){var e,n,r,i,o;if(null==t)return this.entries;for(n=[],o=this.entries,r=0,i=o.length;i>r;r++)e=o[r],e.type===t&&n.push(e);return n},checkMaxLogStack:function(){return this.entries.length<=this.maxEntries?!0:this.entries.shift()},empty:function(){return this.entries.length=0,!0}},l=function(t,e,n,i){return null==i&&(i="log"),r.append(t,e,n,i)},c=function(){return l(arguments[0],arguments[1],arguments[2],"info")},f=function(){return l(arguments[0],arguments[1],arguments[2],"notice")},m=function(){return l(arguments[0],arguments[1],arguments[2],"warn")},s=function(){return l(arguments[0],arguments[1],arguments[2],"error")},o=function(){return r.empty()},u=function(t){return r.getEntries(t)},d=function(t){var e,n,i,o,s;if("undefined"!=typeof console&&null!==console){for(e=r.getEntries(t),o=0,s=e.length;s>o;o++)n=e[o],i=null!=console[n.type]?n.type:"log",n.objectsArray?console[i]("L: ["+n.namespace+"]["+n.type+"]:",n.message,n.objectsArray):console[i]("L: ["+n.namespace+"]["+n.type+"]:",n.message);return e}},h=function(){return!0},p=function(){return!0},a=function(){return 0+r.maxEntries},{log:l,info:c,notice:f,warn:m,error:s,empty:o,getEntries:u,printEntries:d,saveToServer:h,sendStat:p,getMaxEntries:a}})}.call(this),function(){r("utils/ticker",[],function(){var t;return t=function(t,e){return this.period=parseInt(t,10),this._callbacks=[],e&&this.listen(e),this},t.prototype={listen:function(t){return this._callbacks.push(t),this},start:function(){return this._interval=setTimeout(function(t){return function(){return t._tick(),t.start()}}(this),this.period)},stop:function(){return clearTimeout(this._interval)},_tick:function(){var t,e,n,r,i;for(r=this._callbacks,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t());return i}},function(e,n){return new t(e,n)}})}.call(this),function(){r("utils/logWriter",[],function(){return{log:_log,info:_info,warn:warn,error:error}})}.call(this),r("underscore",function(){return t}),n("app")});