window.FOURGE||(window.FOURGE={}),window.FOURGE.LAUNCHER_ERROR_CODE={MOBILE_REQUIRED:1,COUNTRY_MUST_BE_SELECTED:2,DISABLED:3,EMAIL_IS_NOT_CONFIRMED:4,BETA_TESTER_ROLE_REQUIRED:5,SERVICE_ACCOUNT_BANNED:6,SERVICE_ACCOUNT_BLOCKED:7,LICENCE_NOT_ACCEPTED:8,INVALID_SERVICE_PASSWORD:9,USER_NOT_AUTHED:10,COUNTRY_BLOCKED:11,UBERSECURITY_TURNED_OFF:12,EXTENSION_NOT_INSTALLED:13,APOCALYPSE:666},window.FOURGE.ErrorsMixin={hasError:function(e){var t;return t=!!this.errors&&!!this.errors[e]},hasErrors:function(){return!!this.errors},isAuthed:function(){return!this.hasError(window.FOURGE.LAUNCHER_ERROR_CODE.USER_NOT_AUTHED)},getErrorExtra:function(e,t){var n;if(!this.hasError(e))throw"error with code: "+e+" is absent";return n=void 0,this.errors[e].extra&&(n=this.errors[e].extra[t]),n}},function(){var e;e=window,null==e.FOURGE&&(e.FOURGE={}),e.FOURGE.GameData=function(){var e,t,n,i,a,r,o,s,c,l,d,u,p;return n=null,o=new signals.Signal,o.memorize=!0,e=0,a=function(e){return!_(parseInt(e,10)).isNaN()},t=function(e){var t;return t={},_(e).each(function(e,n){if(a(n))return t[n]=e}),t},i=function(e){return _(t(e)).each(function(e,t){return _.extend(e,FOURGE.ErrorsMixin),_(e.accounts).each(function(e){return _.extend(e,FOURGE.ErrorsMixin)})}),_.extend(e,FOURGE.ErrorsMixin)},r=function(t){return function(t){if(null!=t.digest&&e!==t.digest)return e=t.digest,i(t),n=t,o.dispatch(FOURGE.GameData)}}(this),d=function(e){return o.add(e)},u=function(e){return o.addOnce(e)},c=function(e){return n[e]?n[e].accounts:[]},l=function(){return t(n)},s=function(e,t){var i;return i=function(t){return Boolean(t.service_account_id===e)},null!=t?null!=n[t]?_(c(t)).find(i):null:_(l()).each(function(e){var t;if(t=_(e.accounts).find(i),null!=t)return t})},p=function(e){return function(e){var t,i;return t=$.Deferred(),!e&&$("body").data("game-data")?(i=$("body").data("game-data"),i.digest=1,$("body").data("game-data",null),r(i),t.resolve(i)):require(["global/launcher"],function(i){return i.gameData(e).then(function(e){return r(e),t.resolve(e)},function(e){return n=void 0,t.reject(e)})}),t}}(this),{getAccountsForGame:c,getAccount:s,requestData:p,onUpdate:d,onUpdateOnce:u,getGames:function(){return _.clone(n)},getGame:function(e){return null!=n[e]?_.clone(n[e]):void 0},getGamesElements:l}}()}.call(this),function(){var e;e=window,null==e.FOURGE&&(e.FOURGE={}),e.FOURGE.UserData=function(){var e,t,n,i,a;return n=new signals.Signal,n.memorize=!0,e=0,t=function(t){if(null!=t.digest&&t.digest!==e)return FOURGE.UserData.user=_.extend(t,FOURGE.ErrorsMixin),e=t.digest,n.dispatch(FOURGE.UserData)},a=function(e){var n,i;return n=$.Deferred(),!e&&FOURGE.UserData.user?n.resolve(FOURGE.UserData.user):(!e&&$("body").data("user-data")?(i=$("body").data("user-data"),i.digest=1,$("body").data("user-data",null),t(i),n.resolve(i)):require(["global/launcher"],function(i){return i.userData(e).then(function(e){return t(e),n.resolve(e)},function(e){return FOURGE.UserData.user=null,n.reject(e)})}),n)},i=function(e,t){return t?n.addOnce(e):n.add(e)},{requestData:a,onUpdate:i,user:null}}()}.call(this),window.FOURGE||(window.FOURGE={}),window.FOURGE.ServiceLicences=function(){var e={},t=function(t){if(_(e[t]).isUndefined())throw"no info for serviceId:"+t;return e[t]},n=function(){_(FOURGE.GameData.getGamesElements()).each(function(t,n){e[n]||(e[n]=!t.hasError(FOURGE.LAUNCHER_ERROR_CODE.LICENCE_NOT_ACCEPTED))})};FOURGE.GameData.onUpdate(n);var i=function(t,n){var i=new $.Deferred;return $.ajax({url:"/launcher/licenceAccept",type:"post",data:{serviceId:t,licenceType:n}}).done(function(n){return n.result?(e[t]=!0,void i.resolve()):void i.reject()}).fail(function(){i.reject()}),i.promise()};return{isAccepted:function(e){return t(e)},accept:i}}(),function(){var e;e=window,null==e.FOURGE&&(e.FOURGE={}),e.FOURGE.utils={loadModule:function(e,t,n){var i,a,r,o;return null==n&&(n="./"),o="",a={},_.isString(e)?a[e]=t:a=e,r=_(a).size(),i=1,_(a).each(function(e,t){return o=o+t+": "+e,i<r&&(o+=";"),i++}),this.loadModuleDirect(n,o)},loadModuleDirect:function(e,t,n){var i,a;return i=window.location.search,i&&n&&(e.indexOf("?")>-1?e=e.replace("?",i):e+=i),e=decodeURIComponent(e),a=$('<a href="'+e+"\" data-reload-sections='"+t+"'></a>"),a.appendTo("body").get(0).click(),a.detach()},loadModuleByForm:function(e,t,n){return this.fullPostPage(e,n,{"data-reload-sections":t})},postWithUrl:function(e,t,n){return require(["packages/che"],function(i){return function(a){return a.history?a.events.trigger("pageTransition:init",[e,t,"POST",n]):i.fullPostPage(e,n)}}(this))},fullPostPage:function(e,t,n){var i,a,r,o,s,c;if(s="",t)for(o in t)c=t[o],s+='<input type="hidden" name="'+o+'" value="'+c+'"/>';if(a="",n)for(o in n)c=n[o],a+=o+'="'+c+'" ';return r='<form action="'+e+'" '+a+' method="POST">'+s+"</form>",i=$(r).appendTo("body"),i.submit(),setTimeout(function(){return i.remove()},100)},callPopup:function(e,t){return this.loadModule(e,"#OverlayContent","./?popupWidget="+e+t)},resetUser:function(){var e,t;return e={target:"#OverlayContent",ns:"popup"},t="AuthPopupWidget: "+JSON.stringify(e),this.loadModuleDirect("./?popupWidget=AuthPopupWidget",t),require(["packages/che"],function(e){return e.events.trigger("update-userinfo")})},toLocaleFormat:function(t){return t.toString().replace(/\./g,e.Inn.i18n.__t__("Interface","NumberSymbolDecimal"))},striptags:function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.textContent||t.innerText||""}}}.call(this),window.log=function(){if(log.history=log.history||[],log.history.push(arguments),this.console){var e,t=arguments;t.callee=t.callee.caller,e=[].slice.call(t),"object"==typeof console.log?log.apply.call(console.log,console,e):console.log.apply(console,e)}},function(e){function t(){}for(var n,i="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(",");n=i.pop();)e[n]=e[n]||t}(function(){try{return console.log(),window.console}catch(e){return window.console={}}}()),function(e,t){var n=t.extend({debugLevel:0,fakePluginAvailable:0},t('script[src*="l4g"][data-options]').first().data("options")),i=!0;FOURGE.fakePluginAvailable=i&&n.fakePluginAvailable,FOURGE.debugLevel=n.debugLevel;var a=function(){var t={error:1,warn:2,info:4,log:5},i=function(i,a){!e.console||!e.console[i]||n.debugLevel<t[i]||e.console[i].apply(e.console,a)},a={};for(var r in t)t.hasOwnProperty(r)&&(a[r]=function(){i(r,arguments)});return a}(),r=new signals.Signal;e.L4G={registerModule:function(e,t){return"string"!=typeof e?(a&&a.error("module id is not a string"),!1):/^[a-z\.0-9_]{2,64}$/i.test(e)?"function"!=typeof t?(a&&a.error("module `"+e+"` constructor is not a function"),!1):(r.dispatch(e,t),!0):(a&&a.error("module id `"+e+"` is not a valid string"),!1)},signalHandlers:t.Deferred()};var o=function(e,n){this.id=e,this.callbacks=n,this.signals={started:!0,log:!0,error:!0,warning:!0,info:!0},this.init=function(){},this._updateStatus=function(e,n,i){var a=this;t(document).ready(function(){for(var e=0;e<i.services.length;e++){var t=i.services[e],n=a._getGamesCollection(t.serviceId);n&&n.length&&a._processStatus.call(a,n,t)}})}};o.prototype={getSignals:function(){return this.signals},listen:function(){return this.callbacks.listen.apply(this,arguments)},notify:function(){return this.callbacks.notify.apply(this,arguments)},request:function(){return this.callbacks.request.apply(this,arguments)},onRequest:function(){return this.callbacks.onRequest.apply(this,arguments)},removeRequest:function(){return this.callbacks.removeRequest.apply(this,arguments)},enableSignal:function(){return this.callbacks.enableSignal.apply(this,arguments)},disableSignal:function(){return this.callbacks.disableSignal.apply(this,arguments)},_getGamesCollection:function(t){return t?e.oGameCollection.getItemsById.call(e.oGameCollection,t):e.oGameCollection.getItems.call(e.oGameCollection)},_tryToSetState:function(e,t){for(var n in e)e[n].setState(t)}};var s=function(e,n,i){var r=this;r.moduleId=e,r.signals={},r.requestedSignals={},r.wantedToListen=new signals.Signal,r.wantedToListen.memorize=!0,r.requested=new signals.Signal,r.requested.memorize=!0,r.signalActiveChanged=new signals.Signal,r.signalActiveChanged.memorize=!1,r.init=function(){r.module.init.call(r.module)},r.module=n.call(new o(e,{listen:function(e,t,n){a&&a.info("Module `%s` wanted to listen `%s/%s`",r.moduleId,e,t),r.wantedToListen.dispatch(e,t,n)},notify:function(e,t){"object"==typeof r.signals[e]?(a&&a.info("[WRAPPER] Module `%s` dispatched `%s` with data: %o",r.moduleId,e,t||{}),r.signals[e].dispatch(r.moduleId,e,t||{})):a&&a.warn("Module `"+r.moduleId+"` notified undefined signal `"+e.toString()+"`")},request:function(e,t,n){a&&a.info("[WRAPPER] Module `%s` requested `%s/%s` with data: %o",r.moduleId,e,t,n||{}),r.requested.dispatch(e,t,n||{})},onRequest:function(e,t){"undefined"!=typeof r.requestedSignals[e]?(a&&a.info("[WRAPPER] Module `%s` added callback for requested signal `%s`",r.moduleId,e),r.requestedSignals[e].add(t,r.module)):a&&a.warn("Signal `"+r.moduleId+"/"+e+"` of can not be requested")},removeRequest:function(e,t){"undefined"!=typeof r.requestedSignals[e]?(a&&a.info("[WRAPPER] Module `%s` removed callback for requested signal `%s`",r.moduleId,e),r.requestedSignals[e].remove(t,r.module)):a&&a.warn("Signal `"+r.moduleId+"/"+e+"` of can not be requested")},enableSignal:function(e){"undefined"!=typeof r.signals[e]&&(r.signals[e].active=!0),"undefined"!=typeof r.requestedSignals[e]&&(r.requestedSignals[e].active=!0,r.signalActiveChanged.dispatch(r.moduleId,e))},disableSignal:function(e){"undefined"!=typeof r.signals[e]&&(r.signals[e].active=!1),"undefined"!=typeof r.requestedSignals[e]&&(r.requestedSignals[e].active=!1)}}),i),t.each(r.module.getSignals(),function(e,t){/^[a-z0-9_-]{1,64}$/i.test(e)&&(t="boolean"==typeof t?{canBeRequested:t}:t,r.signals[e]=new signals.Signal,r.signals[e].memorize=!0,t.active===!1&&(r.signals[e].active=!1),t.canBeRequested&&(r.requestedSignals[e]=new signals.Signal,r.requestedSignals[e].memorize=!0,t.active===!1&&(r.requestedSignals[e].active=!1)))})};!function(){var e=["L4G.Application","L4G.Status","L4G.PluginFault","L4G.User","L4G.Maintenance","L4G.Statistics","L4G.ProgressInfo","L4G.Update","L4G.Install","L4G.Play","L4G.Tuning","L4G.Adapter"],o={"L4G.Adapter":["*","*"]};i&&(e.push("L4G.Console"),o["L4G.Console"]=["*","*"]);var c={},l={},d={},u=function(e,t,n){return"*"!=t&&"*"!=n||"undefined"!=typeof o[e]&&!("*"!=o[e][0]&&t!=o[e][0]||"*"!=o[e][1]&&n!=o[e][1])},p=function(e,t,n,i){"undefined"==typeof l[e]&&(l[e]={}),"undefined"==typeof l[e][t]&&(l[e][t]=[]),l[e][t].push({callback:n,context:i})},f=function(e,n,i,r){if(!u(this.moduleId,e,n))return a&&a.warn("Module `%s` doesn't have rights to listen `%s/%s`",this.moduleId,e,n),!1;if(a&&a.info("Module `%s` wanted to listen `%s/%s`",this.moduleId,e,n),"*"==e&&"*"==n){var o=this;t.each(c,function(e){t.each(c[e].signals,function(t){f.call(o,e,t,i,!0)})}),r||p(e,n,i,this.module)}else if("*"==e){var o=this;t.each(c,function(e){f.call(o,e,n,i,!0)}),r||p(e,n,i,this.module)}else if("undefined"!=typeof c[e])if("*"==n){var o=this;t.each(c[e].signals,function(t){f.call(o,e,t,i,!0)}),r||p(e,n,i,this.module)}else"undefined"!=typeof c[e].signals[n]&&c[e].signals[n].add(i,this.module);else r||p(e,n,i,this.module)},g=function(e){"object"==typeof l[e.moduleId]&&(t.each(e.signals,function(n){var i=this;"undefined"!=typeof l[e.moduleId][n]&&t.each(l[e.moduleId][n],function(){i.add(this.callback,this.context)}),"undefined"!=typeof l[e.moduleId]["*"]&&t.each(l[e.moduleId]["*"],function(){i.add(this.callback,this.context)})}),l[e.moduleId]=null,delete l[e.moduleId]),"object"==typeof l["*"]&&t.each(c[e.moduleId].signals,function(e){var n=this;"undefined"!=typeof l["*"][e]&&t.each(l["*"][e],function(){n.add(this.callback,this.context)}),"undefined"!=typeof l["*"]["*"]&&t.each(l["*"]["*"],function(){n.add(this.callback,this.context)})})},m=function(e,t,n){"undefined"!=typeof c[e]?"undefined"!=typeof c[e].requestedSignals[t]?(a&&a.info("[CORE] Module `%s` requested `%s/%s` with data %o",this.moduleId,e,t,n),c[e].requestedSignals[t].active?c[e].requestedSignals[t].dispatch(this.moduleId,t,n):h.apply(this,arguments)):a&&a.warn("Signal `"+t+"` of module `"+e+"` can not be requested by `"+this.moduleId+"`"):h.apply(this,arguments)},h=function(e,t,n){"undefined"==typeof d[e]&&(d[e]={}),"undefined"==typeof d[e][t]&&(d[e][t]=[]),d[e][t].push({data:n,module:this})},v=function(e,n){return"undefined"!=typeof d[e]&&("string"==typeof n&&"undefined"!=typeof d[e][n]?S(e,n):t.each(d[e],function(t){S(e,t)}),void(d[e].length||(d[e]=null,delete d[e])))},S=function(e,n){c[e].requestedSignals[n].active&&(t.each(d[e][n],function(){c[e].requestedSignals[n].dispatch(this.module.moduleId,n,this.data)}),d[e][n]=null,delete d[e][n])};r.add(function(t,require,i){return a&&a.log("[CORE] [moduleAvailable] this = %o, args = %o",this,arguments),"undefined"!=typeof e[t]?void(a&&a.warn("module `"+t+"` is not accepted")):"undefined"!=typeof c[t]?void(a&&a.warn("module `"+t+"` already exists")):("function"==typeof require&&(i=require,require=[]),c[t]=new s(t,i,n[t]||{}),c[t].wantedToListen.add(f,c[t]),c[t].requested.add(m,c[t]),c[t].signalActiveChanged.add(v),g(c[t]),c[t].init(),void v(t))})}()}(this,jQuery),L4G.registerModule("L4G.Application",function(e){function t(e){return g[e]||e}function n(e){return e.replace(/[&<>]/g,t)}function i(e){for(var t in e)"string"==typeof e[t]?e[t]=n(e[t]):"object"==typeof e[t]&&(e[t]=i(e[t]));return e}var a,r=this,o=_.extend({needUpdateServiceVersion:!1,needUpdatePluginVersion:!1,needUpdateTrayVersion:!1},e),s={incoming:{status:!0,appIdentity:!0,availableServices:!0,warning:!0,notification:!0,setInstallDir:!0,setDefaultInstallDir:!0,sendStat:!0,setVersions:!0,setFeature:!0,dependencyCheck:!0},outgoing:{getStatus:!0,getAppIdentity:!0,install:!0,update:!0,cancel:!0,pause:!0,resume:!0,"play:":!0,configure:!0,browseDir:!0,setData:!0,logError:!0,getPCSpecStat:!0,getPingStat:!0,getDefaultInstallDir:!0,getVersion:!0,getData:!0,getFeature:!0,installComponent:!0,setEnvironment:!0,dependencyCheck:!0,getTrackingData:!0}};r.signals.fault=!0,r.signals.exist=!0,r.signals["working-mode"]=!0,r.signals.send=!0,r.signals.sended=!0,r.signals.message=!0;for(var c in s.incoming)r.signals["in-"+c]=!0;for(var c in s.outgoing)r.signals["out-"+c]=!0;var l=function(e,t,n){I(n)},d=function(e,t,n){I({name:t.substr(4),data:n})},u=function(){r.removeRequest("send",l),r.onRequest("send",l);for(var e in s.incoming)r.removeRequest("in-"+e,b),r.onRequest("in-"+e,b);for(var e in s.outgoing)r.removeRequest("out-"+e,d),r.onRequest("out-"+e,d)},p=function(e,t){if(e&&"string"==typeof e&&t&&"string"==typeof t){var n=e.split("."),i=t.split(".");if(n.length==i.length&&4==n.length)for(var a=0;a<n.length;a++){if(n[a]>i[a])return!1;if(n[a]<i[a])return!0}}return!1},f=function(e){(+e.need_update||p(e.serviceVersion,o.needUpdateServiceVersion)||p(e.trayVersion,o.needUpdateTrayVersion)||p(e.pluginVersion,o.needUpdatePluginVersion))&&a.needUpdate()},g={"<":"&lt;"},m=function(e,t){if("string"==typeof t)try{t=t.replace(/\\/g,"\\\\"),t=$.parseJSON(t)}catch(n){var a={name:"message"};a.data={badJson:t},t=a}t=i(t),"message"===e&&"string"==typeof t.name&&"object"==typeof t.data?("setVersions"==t.name&&f(t.data),$(function(){return"error"===t.name?void S(t.data):void(s.incoming[t.name]?r.notify("in-"+t.name,t.data):r.notify("message",{name:t.name,data:t.data}))})):"send"===e&&"string"==typeof t.name&&"object"==typeof t.data&&$(function(){s.incoming[t.name]?r.notify("out-"+t.name,t.data):r.notify("send",{name:t.name,data:t.data})})},h={"!":new signals.Signal,"*":new signals.Signal},v=function(e){return $("<div/>").text(e).html()},S=function(e){var t,n,i=_.isString(e.code)?parseInt(e.code,10):e.code;if(isNaN(i))throw"Could not parse code: "+e.code;if(t={code:i,description:v(e.desc)||""},e.extra&&_.isString(e.extra)){n="{"===e.extra.charAt(0);try{t.extra=n?JSON.parse(e.extra):v(e.extra)}catch(a){t.extra=v(e.extra)}t.extraPrintable=v(e.extra)}else _.isObject(e.extra)&&(t.extra=e.extra);return e.serviceId&&(t.serviceId=e.serviceId),h["*"].dispatch(t),i&&h[i]&&0!==h[i].getNumListeners()?void h[i].dispatch(t):void h["!"].dispatch(t)},y=function(e,t,n,i){var a,r=parseInt(e,10);if(_.isString(e)&&!isNaN(r)&&(e=r),!_.isFinite(e)&&"!"!==e&&"*"!==e)throw"invalid code argument";return a=n?"addOnce":"add",h[e]||(h[e]=new signals.Signal),h[e][a](t,i)},D=function(e,t,n){return"undefined"!=typeof h[e]&&("undefined"==typeof h[e]?h[e].remove(t):h[e].remove(t,n))},b=function(e,t,n){("L4G.Console"==e||"L4G.Status"==e&&"in-status"==t)&&m("message",{name:t.slice(3),data:n})},I=function(e){if(!_.isUndefined(e.name)){if(!a)throw r.notify("error","No interface defined"),"No interface defined";a.send(e.name,e.data||{}),r.notify(e.name,e.data)}};return r.init=function(){require(["packages/l4gApp","l4g/assets/app-interface","global/l4g-stat","packages/che"],function(e,t,n,i){a=t.get(),u(),e.backend.on("working-mode",function(e){r.notify("working-mode",e)}).on("message",function(e){m("message",e)}),r.notify("started","L4G: Module Application"),L4G.signalHandlers.resolve({attachToErrorSignal:y,detachFromErrorSignal:D,receivedHandler:m,signalRequestHandler:I}),e.init(),i.events.bind("gameDownload:started",function(){e.backend.accelerate()}),i.events.bind("browserPlugins:refresh",function(){e.backend.refresh()}),i.events.bind("autoUpdate:started",function(){e.backend.reconnectUntilSucceed()}),e.backend.on("broken",function(){i.events.trigger("browserPlugins:refresh_fail")}),e.backend.addFilter(function(e,t){return"play"!=e.name?t():void window.FOURGE.GameData.onUpdateOnce(function(n){var i=n.getGame(e.data.serviceId);t(i&&2==i.type)})})})},this}),Function.prototype.bind&&console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.call(console[e],console)},Function.prototype.bind),window._log||(window._log=function(){if(log.history=log.history||[],log.history.push(arguments),"undefined"!=typeof console&&"function"==typeof console.log)if(window.opera)for(var e=0;e<arguments.length;)console.log("Item "+(e+1)+": "+arguments[e]),e++;else 1==Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(Array.prototype.slice.call(arguments).toString()):console.log(Array.prototype.slice.call(arguments));else if(Function.prototype.bind||"undefined"==typeof console||"object"!=typeof console.log)if(document.getElementById("firebug-lite"))setTimeout(function(){log(Array.prototype.slice.call(arguments))},500);else{var t=document.createElement("script");t.type="text/javascript",t.id="firebug-lite",t.src="https://getfirebug.com/firebug-lite.js",document.getElementsByTagName("HEAD")[0].appendChild(t),setTimeout(function(){log(Array.prototype.slice.call(arguments))},2e3)}else Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))}),$(function(){window.Inn=window.Inn||{},window.Inn.BasicConsole=function(){var e=null,t={send:[],receive:[]},n=function(){require(["l4g/assets/app-interface"],function(t){e=t.get()})},i=function(){window.FOURGE.fakePluginAvailable=!0,require(["l4g/assets/app-interface"],function(t){t.set(function(t){e=t})})},a=function(e,n){var i={};if(!(t.send.length<1)){i.name=n.name,i.data=n.data||{},i.selfSending=n.selfSending||!1,"string"==typeof i.data&&(i.data=JSON.parse(i.data));for(var a=0;a<t.send.length;a++)t.send[a](i.name,i.data,i.selfSending)}},r=function(e,n){if(!(t.receive.length<1)){var i="string"==typeof n?JSON.parse(n):n,a={message:i};a.fakeReceive=i.fakeReceive||!1,"undefined"!=typeof i.name&&(a.name=i.name),"undefined"!=typeof i.data&&(a.data=i.data);for(var r=0;r<t.receive.length;r++)t.receive[r](a.name,a.data,a.fakeReceive)}},o=function(t,n){e.send(t,n),a(!1,{name:t,data:n,selfSending:!0})},s=function(t,n){e.getListener()("message",{name:t,data:n});var i="",a=n||{};a.fakeReceive=!0,i=JSON.stringify({name:t,data:a}),r(!1,i)},c=function(e,n){"undefined"!=typeof t[e]&&t[e].push(n)};return{init:function(){n()},initFake:function(){i()},initPlugin:function(){n()},send:function(e,t){o(e,t)},receive:function(e,t){s(e,t)},isValid:function(){return!0},getConnectionLayer:function(){if(e&&e.id)return e.id},listenSending:function(e){c("send",e)},listenReceiving:function(e){c("receive",e)}}}()}),define("/js/l4g/l4g.dev_console_presets.js",function(require,exports,e){var t={serviceId:8,serviceList:[2,6,8],serviceLogin:"tester",servicePassword:"123456",payloadEncrypted:"i1s2RDz/OR7xzQI4EFJ64ohbEdg67jZ/thpiEv6jFSgbLI2/VtOXbvyZEDXuPl/rwzAbeyc52aFG↵COsKFtUr8Vm8pTBQmEyLBvqG0Fi8R+EhQkuMjk/xf08Au+eWdYsgCg79E0aBW6HH+cnPJQz3JtBe↵GyknhGXHCdJ1mz1Tq+8=",accountId:91123,pathToFolder:"C:/Program Files (x86)/4game/",browseDirCaption:"Path to folder",dataName:"userCookie",dataValue:"someCookieValue",pluginVersion:"0.9.0.1",launcherVersion:"1.0.4.28",isFullUpdate:!1,extendedStatus:"extended_status",errorCode:345,errorMessage:"All is going bad",downloader:{version:"1.0.6.5"},pingIp:"127.0.0.1"};return{incoming:{status:{jData:{services:[{serviceId:2,status:"progress",environment:"live",extendedStatus:"full",readyStage:1,info:{progress:25,speed:56,size:950645,dl_size:750645,downloaded:12,estimated:506545,fileName:"rus.pak",fileProgress:{size:1234567,downloaded:1234},stageSizes:[344100,204100,380445]}},{serviceId:9,status:"full_update_required",environment:"live",extendedStatus:"full",info:{progress:25,speed:56,size:950645,dl_size:750645,downloaded:12,estimated:506545,fileName:"rus.pak",fileProgress:{size:1234567,downloaded:1234}}},{serviceId:6,status:"installed",environment:"pts",extendedStatus:"full",info:"ascsa",configurable:!0},{serviceId:1007,status:"installed",environment:"qa",extendedStatus:"full",info:"ascsa",configurable:!0}]}},appIdentity:{jData:{appId:"{325ad919-5ffb-489d-97c4-8e0ba54f9f3a}",hwId:"36fba50a7fb4fe5ee262cf209f95553fea916738",publicKey:"\\uSPSDKICDJw\\uLMQKg9vqmQDDYkK4+KVTZp2tbaVP2YHI6sKgMPQIOozg05eEtkF+cRHSjkPr\\r\\nf3lamEFfLdpU8keK90dstYlBKjJ1e+foZ4UPFiJR0Ype0iRTVnQxz\\uwLyYa\\/Zk6mmZn7eqwL\\r\\nxWRQ85tO9PUrdxqh3mcXogETU7c=;Aw=="}},availableServices:{jData:{services:[2,6,8],environment:"qa"}},error:{jData:{code:700,desc:"Ohohoh"}},notification:{jData:{message:"It's notification",code:801}},warning:{jData:{message:"It's Warning"}},reloadPlugin:{jData:{}},setInstallDir:{jData:{serviceId:6,path:"D:/Games/Lineage 2 New"}},setDefaultInstallDir:{jData:{serviceId:6,path:"C:/Games/Lineage 2"}},sendStat:{jData:{event_type:"test",event_attr1:"event_val1"}},setVersions:{jData:{pluginVersion:"2.0.0.74",serviceVersion:"2.0.0.74",trayVersion:"2.0.0.74",need_update:"1"}}},outgoing:{send:{getStatus:{jData:{serviceId:t.serviceList}},getAppIdentity:{jData:{}},install:{jData:{serviceId:t.serviceId,path:t.pathToFolder,extended_status:t.extendedStatus,isFullUpdate:t.isFullUpdate}},update:{jData:{serviceId:t.serviceId,isFullUpdate:!0}},repair:{jData:{serviceId:t.serviceId,isFullUpdate:!0}},cancel:{jData:{serviceId:t.serviceId}},pause:{jData:{serviceId:t.serviceId}},resume:{jData:{serviceId:t.serviceId}},play:{jData:{serviceId:t.serviceId,login:t.serviceLogin,password:t.servicePassword,accountId:t.accountId}},playEncrypted:{jData:{serviceId:t.serviceId,login:t.serviceLogin,payloadEncrypted:t.payloadEncrypted,accountId:t.accountId}},configure:{jData:{serviceId:t.serviceId}},browseDir:{jData:{path:t.pathToFolder,caption:t.browseDirCaption,serviceId:t.serviceId}},changeDefaultInstallDir:{jData:{serviceId:t.serviceId,value:t.pathToFolder}},installComponent:{jData:{component:"PhysX",serviceId:17}},setData:{jData:{name:t.dataName,value:t.dataValue}},logError:{jData:{serviceId:t.serviceId,code:t.errorCode,message:t.errorMessage}},getPCSpecStat:{jData:{}},getPingStat:{jData:{ip:t.pingIp}},getDefaultInstallDir:{jData:{serviceId:t.serviceId},returnData:{path:t.pathToFolder}},getVersions:{jData:{},returnData:{plugin:t.pluginVersion,launcher:t.launcherVersion}},getPluginVersion:{jData:{},returnData:{plugin:t.pluginVersion,launcher:t.launcherVersion}},getData:{jData:{name:t.dataName},returnData:{value:t.dataValue}},getFeature:{jData:{},returnData:{downloader:t.downloader.version}},getAppIdentity:{jData:{}},getTrackingData:{jData:{}}}},request:{"L4G.User":{getUserData:{callbackSignal:"log"},getLastUserData:{callbackSignal:"log"}},"L4G.Install":{putUserData:{user:{auth:!1},games:null,messages:null}},"L4G.Statistics":{logError:{code:0,message:"test"}}}}}),require(["packages/jquery","packages/l4gApp","packages/che","global/utils/gamepanel"],function(e,t,n,i){L4G.registerModule("L4G.Adapter",function(t){var a={},r=null,o=this,s=e(document),c={},l=!1,d={};o.signals.putUserData=!0,o.signals["start-intercept-install-dir"]=!0,o.signals["finish-intercept-install-dir"]=!0,o.signals.startInstall=!0,o.l4g={send:function(e,t){o.request("L4G.Application","send",{name:e,data:t,moduleId:o.id})},updateUserData:function(){o.request("L4G.User","getUserData",{callbackSignal:"putUserData"})},forceUpdateGameData:function(){FOURGE.GameData.requestData(!0)},forceUpdateUserData:function(){o.request("L4G.User","getLastUserData",{callbackSignal:"putUserData"})}};var u=Array.prototype.slice,p=Backbone.Model.extend({initialize:function(){this.on("change:L4G.Application/error",function(e,t){var n=e.get("Game/current.serviceId");n&&e.update("L4G.Application/services."+n+".error",t)}),require(["i18n_t","i18n_plural"],function(e,t){this.set({t:e,utils:i,plural:t},{silent:!0})}.bind(this))},attachErrorListener:function(){var e=u.call(arguments,0),t=this;L4G.signalHandlers.done(function(n){n.attachToErrorSignal.apply(t,e)})},detachErrorListener:function(){var e=u.call(arguments,0),t=this;L4G.signalHandlers.done(function(n){n.detachFromErrorSignal.apply(t,e)})},update:function(e,t,n){if("log"===t)return!1;var i=[e,t].join("/");if("L4G.Application/in-status"===i)for(var a in n.services){var r=n.services[a].serviceId;this.clearKeys(i+".services."+r,!0),this._flatten(n.services[a],i+".services."+r),h(r,n.services[a].status,n.services[a].action),"progress"===n.services[a].status&&"install"===n.services[a].action&&b(r)}else this.clearKeys(i,!0),this._flatten(n,i);this.change()},clearKeys:function(e,t){var n={silent:t};for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&(i===e||i.indexOf(e+".")>-1)&&this.unset(i,n)},_flatten:function(e,t){if("string"==typeof t&&(t=[t]),t=t||[],"function"!=typeof e&&(this.set(t.join("."),e,{silent:!0}),"object"==typeof e))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this._flatten(e[n],t.concat([n]));return this},clearErrors:function(){var e=["L4G.Application/error","L4G.Application/error.code","L4G.Application/error.description"],t=this.get("Game/current.serviceId");t&&(e=e.concat(["L4G.Application/services."+t+".error","L4G.Application/services."+t+".error.code","L4G.Application/services."+t+".error.description"])),e.forEach(function(e){this.unset(e,{silent:!0})}.bind(this))},setError:function(e){this.update("L4G.Application","error",e)},setErrorFor:function(e,t){this.update("L4G.Application","services."+e+".error",t)},getCurrentErrorCode:function(){return this.get("L4G.Application/error.code")||this.get("L4G.Application/services."+this.get("Game/current.serviceId")+".error.code")}});o.adapter=new p({"MyGames/sortOrder":window.gamesOrder,"MyGames/gameData":window.gamesList});var f=function(e){o.notify(e)},g=function(){var t=e("#GamePanel"),n=e("#SecondaryGamePanel"),i=!!t.length,s=!!n.length;return!t.length||"undefined"!=typeof a&&"undefined"!=typeof a.el&&a.el===t[0]||("undefined"!=typeof a&&"undefined"!=typeof a.el&&(i=!!a.checkIfDestroyNeeded()),i&&require(["bGamePanel__layout__view","packages/backbone"],function(e,n){a=new e({el:t[0],l4g:o.l4g,moduleNotify:f},o.adapter)}),null!=r&&null!=r.el&&(s=!!r.checkIfDestroyNeeded()),void(n.length&&s&&require(["bGamePanel__layout__view","packages/backbone"],function(e,t){var i=n[0];null==o.secondaryAdapter&&(o.secondaryAdapter=new(p.extend({toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return delete e["Layout/panel.isCompact"],e}}))(o.adapter.toJSON()),o.adapter.bind("all",function(e,t,n){e=e.replace(/^change\:/,""),"change"!=e&&0!==e.indexOf("Game/current.")&&o.secondaryAdapter.set(e,n)})),r=new e({el:i,l4g:o.l4g,moduleNotify:f,id:i.id},o.secondaryAdapter)})))},m=function(){FOURGE.GameData.getGames()&&(o.adapter.update("GameData","services",FOURGE.GameData.getGamesElements()),l||(g(),l=!0))},h=function(t,n,i){var a=null;switch(n){case"installed":case"update_required":case"full_update_required":case"finished":n="installed",a=1;break;case"progress":case"pausing":case"paused":case"canceling":case"canceled":"install"===i?n="not_installed":(n="installed",a=1);break;case"not_installed":n="not_installed"}c[t]=n,s.trigger("l4g-game-status",c),e.cookie("inst_"+t,a,{expires:15,path:"/"})},v=function(){s.trigger("l4g-game-status",c)},S=function(){o.adapter.set("Layout/panel.isCompact",!0)},y=function(){o.adapter.set("Layout/panel.isCompact",!1)},D=function(e,t,n){return!!(n&&n.serviceId&&n.callback)&&(d[n.serviceId]||(d[n.serviceId]=[]),void d[n.serviceId].push(n.callback))},b=function(e){var t,n;if(d[e]&&d[e].length){for(t=0,n=d[e].length;t<n;t++)d[e][t]();d[e]=null}};return o.init=function(){o.listen("L4G.Application","*",_.bind(o.adapter.update,o.adapter)),o.listen("L4G.User","*",_.bind(o.adapter.update,o.adapter)),o.listen("L4G.Maintenance","*",_.bind(o.adapter.update,o.adapter)),o.request("L4G.User","getUserData",{callbackSignal:"putUserData"}),o.onRequest("startInstall",D),n.events.bind("pageTransition:success",function(e){y(),o.l4g.updateUserData(),g()}),n.events.bind("section-SetCountryWidget:inserted",function(){FOURGE.UserData.requestData().always(function(){FOURGE.GameData.requestData()})}),e(function(){var t=e("body");FOURGE.GameData.onUpdate(m),FOURGE.GameData.requestData(),o.adapter.set("L4G.Area",t.data("area")),o.adapter.set("L4G.Currency",t.data("currency"))}),s.on("l4g-plugin-status",v),s.on("l4g-panel-became-compact",S),s.on("l4g-panel-became-expand",y),s.on("get-l4g-model-status",function(){"undefined"!=typeof o.adapter&&s.trigger("l4g-model-ready",{model:o.adapter})}),o.notify("started"),o.l4g.send("getVersions"),o.l4g.send("getStatus")},this})}),$(document).on("dev-console-ready",function(e,t){require(["/js/l4g/l4g.dev_console_presets.js","packages/backbone"],function(e,n){L4G.registerModule("L4G.Console",function(i){var a=this,r=n.Model.extend({initialize:function(){var e=this.get("signalName"),t=e.replace(/^(in|out)-/,"");this.set("prettySignalName",t),_.indexOf(r.knownEvents,e)===-1&&_.indexOf(r.knownEvents,t)===-1?this.set({signalName:"(?) "+e,color:"yellow"},{silent:!0}):this.set("color",this.getColor(),{silent:!0})},getColor:function(){var t=this.get("moduleId"),n=this.get("signalName"),i=(this.get("dataIn"),this.get("outgoing"));switch(testSignalName="L4G.Application"===t&&"in-"===n.substr(0,3)?n.slice(3):n,testSignalName){case"error":return"red";case"warning":return"yellow";case"started":case"log":return"#1CD3A2";default:if("L4G.Application"===t){if("object"==typeof e.incoming[n.slice(3)])return"#228b22";if(i||"object"==typeof e.outgoing.send[n.slice(4)])return"#6495ed";if("error"!==n)return"yellow"}}return"#ababab"}},{knownEvents:function(){return _.flatten([_.keys(e.incoming),_.keys(e.outgoing.send),_.keys(a.signals),_.map(e.request,function(e){return _.keys(e)})])}()}),o=n.Collection.extend({model:r,initialize:function(){this.on("add",function(e,n){t.log(e.get("dataIn"),e.get("prettySignalName")+"<br />&nbsp;&nbsp;"+e.get("moduleId"),e.get("color"))})}}),s=n.View.extend({tagName:"div",id:"L4GControlPanel",dom:{},initialize:function(e){this.render(),setTimeout(_.bind(function(){this.dom.links.eq(e||0).trigger("click")},this))},render:function(){var t=$(this.el).html(_.template(["<div>",'<h3 style="font-size: 12px">send</h3>','<h3 style="font-size: 12px">message</h3>','<h3 style="font-size: 12px">request</h3>',"</div>",'<form id="L4GConsoleOutgoingSend" style="display: block;">','<select id="L4GConsoleOutgoingSendName" class="method-name">',"<% _.each(outgoing.send, function(item, key) { %>",'<option value="<% print(encodeURIComponent(JSON.stringify(item.jData))) %>"><% print(key) %></option>',"<% }); %>","</select><br />",'<textarea class="data" name="L4GConsoleOutgoingSendParams" id="L4GConsoleOutgoingSendParams" style="width: 350px; height: 170px; font: 12px Courier New;">',"<% print(JSON.stringify(outgoing.send[_.keys(outgoing.send)[0]].jData)) %>","</textarea><br />",'<input type="submit" name="doOutgoingSend" value=" Send " style="width: 350px" />',"</form>",'<form id="L4GConsoleIncomingReceive" style="display: block;">','<select id="L4GConsoleIncomingReceiveName" class="method-name">',"<% _.each(incoming, function(item, key) { %>",'<option value="<% print(encodeURIComponent(JSON.stringify(item.jData))) %>"><% print(key) %></option>',"<% }); %>","</select><br />",'<textarea class="data" name="L4GConsoleIncomingReceiveParams" id="L4GConsoleIncomingReceiveParams" style="width: 350px; height: 170px; font: 12px Courier New;">',"<% print(JSON.stringify(incoming[_.keys(incoming)[0]].jData)) %>","</textarea><br />",'<input type="submit" name="doIncomingReceive" value=" Send " style="width: 350px" />',"</form>",'<form id="L4GConsoleModuleRequest" style="display: block;">','<select id="L4GConsoleModuleRequestName" class="method-name">',"<% _.each(request[_.keys(request)[0]], function(item, key) { %>",'<option value="<% print(encodeURIComponent(JSON.stringify(item))) %>"><% print(key) %></option>',"<% }); %>","</select>&nbsp;",'<select id="L4GConsoleModuleRequestSignal" class="object-name">',"<% _.each(_.keys(request), function(key) { %>",'<option value="<% print(encodeURIComponent(JSON.stringify(request[key]))) %>"><% print(key) %></option>',"<% }); %>","</select><br />",'<textarea class="data" name="L4GConsoleModuleRequestParams" id="L4GConsoleModuleRequestParams" style="width: 350px; height: 170px; font: 12px Courier New;">',"<% var defObject = request[_.keys(request)[0]];","print(JSON.stringify(defObject[_.keys(defObject)[0]])) %>","</textarea><br />",'<input type="submit" name="doModuleRequest" value=" Send " style="width: 350px" />',"</form>"].join(""))(e));
return this.dom.forms=t.find("form"),this.dom.links=t.find("h3"),this.applyStyles(),this},applyStyles:function(){this.dom.forms.css({position:"absolute",top:50,left:20}).hide(),this.dom.links.css({"float":"left",marginRight:10})},events:{"change form .method-name":function(e){var t=$(e.currentTarget),n=t.siblings("textarea"),i=decodeURIComponent(t.val());n.val("undefined"===i?"":i)},"change form .object-name":function(e){var t=$(e.currentTarget),n=t.siblings(".method-name"),i=t.siblings("textarea"),a=JSON.parse(decodeURIComponent(t.val()));n.html(_.template(["<% _.each(request, function(item, key) { %>",'<option value="<% print(encodeURIComponent(JSON.stringify(item))) %>"><% print(key) %></option>',"<% }); %>"].join())({request:a})),i.val(JSON.stringify(a[_.keys(a)[0]]))},"click h3":function(e){var t=$(e.currentTarget),n=t.index();this.dom.forms.hide().eq(n).show(),this.dom.links.css({borderBottom:"1px dashed #efefef",fontWeight:"normal",cursor:"pointer"}),t.css({borderBottom:"none",fontWeight:"bold",cursor:"default"})},"submit form":function(e){var n=$(e.currentTarget),i=n.find(".data").val(),r=n.find(".method-name option:selected").html(),o=n.find(".object-name option:selected").html();e.preventDefault();try{var s=JSON.parse(i)}catch(e){t.log(a.id,"badJson","red")}return n.is("#L4GConsoleOutgoingSend")?(a.request("L4G.Application","send",{name:r,data:s,moduleId:a.id}),a.notify(r,s)):n.is("#L4GConsoleIncomingReceive")?require(["l4g/assets/app-interface"],function(e){e.get().getListener()("message",{name:r,data:s})}):(a.notify("log",["Request to ",o,"/",r," with data ",s].join("")),a.request(o,r,s)),!1}}});a.signals=$.extend(a.signals,{"custom-signal":!0,log:!0,"l4g-force-simulate-mode":!0});for(var c in e.incoming)a.signals[c]=!0;for(var c in e.outgoing.send)a.signals[c]=!0;return this.init=function(n){var i=new o,c=new s(1),l=function(e,t,n,a){"L4G.Application"===t&&"send"===n&&(e="true",n=a.name,a=a.data),i.add(new r({moduleId:t,signalName:n,dataIn:a,outgoing:e}))};t.registerControl(c.el);for(var d in a.signals)"object"!=typeof e.incoming[d]&&"object"!=typeof e.outgoing.send[d]&&a.listen(a.id,d,_.bind(l,null,[!1])),"object"!=typeof e.incoming[d]&&"object"!=typeof e.outgoing.send[d]&&a.listen(a.id,d,_.bind(l,null,[!1]));a.listen("*","*",_.bind(l,null,[!1])),L4G.signalHandlers.done(function(e){e.attachToErrorSignal("*",function(e){l(!1,"L4G.Application","error",e)})}),a.onRequest("log",_.bind(l,null,[!1])),a.notify("started","L4G: Module Console")},this})})}),L4G.registerModule("L4G.Install",function(e){var t=this,n="",i=!0,a={metaContainer:".jsGameItem",container:".jsServiceInstall",btnInstall:".jsBtnServiceInstall",icon:".jsServiceIcon",title:".jsServiceTitle",description:".jsServiceDescription",gameSize:".jsGameSize",modifiers:{errorCheckbox:"mErrorCheckbox"},chooseDir:{chbAcceptLicence:".jsChbAcceptLicence",chbCreateShortcuts:".jsChbCreateShortcuts",container:".jsFolderChooseForm",icon:".jsFolderChooseIcon",title:".jsFolderChooseTitle",description:".jsFolderChooseDescription",gameSize:".bFolderChoose__eDescription span",error723:".bFolderChoose__eError.mError_723",btnClose:".jsEscKey",btnBrowse:".jsBtnFolderChoose",pathInput:".jsUIInput__eControl",acceptLicenceBlock:".jsBlkAcceptLicence",userLicence:".jsUserLicenceLink",simpleLicence:".jsLicenceLink",btnBegin:".jsBtnBeginInstall"}};t._processStatus=function(e,t){};var r=function(){var e=t._getGamesCollection();for(var n in e)e[n].initInstallButton.call(e[n],o)},o=function(e){t.request("L4G.Application","send",{name:"getDefaultInstallDir",data:{serviceId:e},moduleId:t.id})},s=function(e,r,o){if(i&&o.path){n=o.path.replace(/\\\\/g,"\\");var s=$(a.chooseDir.container);$(a.chooseDir.pathInput,s).val(n),$(a.chooseDir.btnClose,s).bind("click",function(e){e.preventDefault(),e.stopPropagation(),l(s)}),s.data("current-service-id",o.serviceId),$(a.chooseDir.btnBrowse,s).bind("click.L4GInstall",function(){var e=$(a.chooseDir.pathInput,s).val().replace(/\\/g,"/");t.request("L4G.Application","send",{name:"browseDir",data:{path:e,caption:FOURGE.utils.striptags(FOURGE.GameData.getGame(o.serviceId).name),serviceId:o.serviceId}})}),$(a.chooseDir.btnBegin,s).bind("click.L4GInstall",function(e){return e.preventDefault(),u()&&$("form",s).submit(),!1}),$("form",s).bind("submit.L4GInstall",function(e){e.preventDefault();var t=!!$(a.chooseDir.chbCreateShortcuts).length&&$(a.chooseDir.chbCreateShortcuts)[0].checked;p($(a.chooseDir.container).data("current-service-id"),$(a.chooseDir.pathInput,a.chooseDir.container).val().replace(/\\/g,"/"),t)});var d=$(a.container,a.metaContainer+"[data-service-id="+o.serviceId+"]"),f=window.FOURGE.GameData.getGame(o.serviceId);$(a.chooseDir.icon,s).attr("src","/c/home/icon-"+o.serviceId+".png"),$(a.chooseDir.title,s).html($(a.chooseDir.title).data("text-prefix")+"<nobr>"+f.name+"</nobr>"),$(a.chooseDir.description,s).html($(a.description,d.closest(a.metaContainer)).html()),$(a.chooseDir.gameSize,s).html($(a.gameSize,d.closest(a.metaContainer)).attr("data-install-size")),$(a.chooseDir.acceptLicenceBlock,s).attr("data-service-id",o.serviceId),$(a.chooseDir.userLicence,s).attr("href",$(a.chooseDir.userLicence,s).data("href")+o.serviceId),$(a.chooseDir.simpleLicence,s).attr("href",$(a.chooseDir.simpleLicence,s).data("href")+o.serviceId),c(s)}},c=function(e){e.appendTo("#OverlayContent").show(),e.find(a.chooseDir.chbAcceptLicence).removeAttr("checked"),$(".bOverlay").show(),setTimeout(function(){e.find(".jsGlow").css("outline","1px solid white").css("outline","none")},500)},l=function(e){e.appendTo("#UserBarWidget").hide(),$(".bOverlay").hide(),$(a.chooseDir.btnBrowse,a.chooseDir.container).add(a.chooseDir.btnBegin,a.chooseDir.container).add(":checkbox",a.chooseDir.container).unbind("click"),$(a.chooseDir.container).data("current-service-id",null),$("form",e).unbind("submit.L4GInstall"),$(a.chooseDir.btnBrowse,e).unbind("click.L4GInstall"),$(a.chooseDir.btnBegin,e).unbind("click.L4GInstall")},d=function(e,t,r){i&&(n=r.path.replace(/\\\\/g,"\\"),$(a.chooseDir.pathInput,a.chooseDir.container).val(r.path))},u=function(){return!!$(a.chooseDir.chbAcceptLicence)[0].checked||($(a.chooseDir.container).addClass(a.modifiers.errorCheckbox),$(a.chooseDir.chbAcceptLicence).unbind("click").bind("click",function(){this.checked?$(a.chooseDir.container).removeClass(a.modifiers.errorCheckbox):$(a.chooseDir.container).addClass(a.modifiers.errorCheckbox)}),!1)},p=function(e,t,i){n=t,f(e,n,i)},f=function(e,n,i){t.request("L4G.Adapter","startInstall",{serviceId:e,callback:g}),$(a.chooseDir.error723).hide(),t.request("L4G.Application","send",{name:"install",data:{serviceId:e,path:n,extendedStatus:"full",isFullUpdate:!1,createShortcut:i},moduleId:t.id}),require(["packages/che"],function(e){e.events.trigger("gameInstall:started")})},g=function(){var e=$(a.chooseDir.container);l(e)},m=function(e){e.serviceId==$(a.chooseDir.container).data("current-service-id")&&$(a.chooseDir.error723).show()},h=function(){i=!0},v=function(){i=!1};return t.init=function(){$(document).ready(function(){t.listen("L4G.Application","in-setDefaultInstallDir",s),t.listen("L4G.Application","in-setInstallDir",d),L4G.signalHandlers.done(function(e){e.attachToErrorSignal("*",function(t){e.attachToErrorSignal(723,m)})}),t.listen("L4G.Tuning","start-intercept-install-dir",v),t.listen("L4G.Tuning","finish-intercept-install-dir",h),t.listen("L4G.Adapter","start-intercept-install-dir",v),t.listen("L4G.Adapter","finish-intercept-install-dir",h),require(["packages/che"],function(e){e.events.bind("pageTransition:success",r)}),r()}),t.notify("started")},this}),require(["packages/jquery","packages/che"],function(e,t){L4G.registerModule("L4G.Maintenance",function(n){var i=this;i.signals.log=!0,i.signals.maintenance=!0;var a=document.documentElement.getAttribute("data-env"),r=e.extend({url:a&&"live"!==a?"https://api.4gametest.com/v3":"https://api.4game.com/v3",updateInterval:60},n);r.updateInterval=1e3*r.updateInterval;var o,s={},c=0,l=function(t,n){if("undefined"!=typeof e.jStorage&&e.jStorage.storageAvailable())return e.jStorage.get(i.id+"."+t,n);if("undefined"!=typeof e.cookie){var a=e.cookie(i.id+"."+t);if(a){if("string"!=typeof a||!/^(\{.*?\}|\[.*?\])$/.test(a))return a;try{return a=e.parseJSON(a),a||n}catch(r){i.notify("log","ERROR can't parse json from cookie '"+i.id+"."+t+"': "+r.toString())}}}return i["___"+t]||n},d=function(t,n,a){"undefined"!=typeof e.jStorage&&e.jStorage.storageAvailable()?e.jStorage.set(i.id+"."+t,n):"undefined"!=typeof e.cookie?e.cookie(i.id+"."+t,"object"==typeof n?JSON.stringify(n):n,e.extend({path:"/",expires:a?new Date(a):-1})):i["___"+t]=n},u=function(){return Boolean(l("inProgress"))},p=function(e){d("inProgress",e?e:null,e?(new Date).getTime()+r.updateInterval/2:null)},f=function(){return(new Date).getTime()-r.updateInterval>=parseInt(l("lastUpdateTime")||0,10)},g=function(){d("lastUpdateTime",(new Date).getTime(),(new Date).getTime()+r.updateInterval)},m=function(){h(),o=window.setInterval(v,r.updateInterval),v()},h=function(){o&&window.clearInterval(o)},v=function(){return(u()||!f())&&c<3?(c++,!1):(c=0,p(!0),e.ajax({url:r.url+"/app-statuses?size=50",crossDomain:!0,timeout:r.updateInterval/2,cache:!0,complete:function(){g(),p(!1)},success:function(e){try{if("object"==typeof e&&e._embedded&&e._embedded.els){for(var t=0;t<e._embedded.els.length;t++){var n=e._embedded.els[t],a=n.appId;s[a]=!0,n.environments.live&&!n.environments.live.status&&(s[a]=!1)}S()}}catch(r){i.notify("log","ERROR "+r.toString())}},error:function(e){var e=window.FOURGE.GameData.getGamesElements();for(var t in e)e.hasOwnProperty(t)&&null==s[t]&&(s[t]=!0);i.notify("log","Maintenance OFF (no answer)"),S()}}),!0)},S=function(){var e={services:{}};d("statuses",s,(new Date).getTime()+r.updateInterval);for(var t in s)e.services[t]=!s[t];i.notify("maintenance",e)},y=function(){v()||S()};return i.init=function(){s=l("statuses",s),e(function(){m(),i.notify("started"),y(),t.events.bind("pageTransition:success",y)})},this})}),L4G.registerModule("L4G.PluginFault",function(e){var t=this;t.signals["update-knowledge"]=!0;var n=!1,i={pluginFault:"l4g-plugin-fault"};t._updateBlocks=function(e,i,a){var r=t._getGamesCollection();if(r&&r.length)switch(a){case"FAULT":n=!0,t._tryToSetState(r,r[0].state.pluginFault),t._initButtons();break;case"NEED_UPDATE":n=!0,t._tryToSetState(r,r[0].state.pluginNeedUpdate),t._initUpdateButtons();break;default:return n=!1,void t._tryToSetState(r,r[0].state.pluginNormal)}},t._initButtons=function(){var e=t._getGamesCollection();for(var n in e)e[n].initDownloadButton(!0)},t._initUpdateButtons=function(){var e=t._getGamesCollection();for(var n in e)e[n].initUpdatePluginButton(!0)};var a=function(){t.request("L4G.Application","working-mode",{callbackSignal:"update-knowledge"})},r=function(){n&&$(document).trigger(i.pluginFault)};return t.init=function(){$(function(){t.listen("L4G.Application","working-mode",t._updateBlocks),t.onRequest("update-knowledge",t._updateBlocks),require(["packages/che"],function(e){e.events.bind("pageTransition:success",a)}),$(document).on("l4g-plugin-status",r)}),t.notify("log","L4G: ModulePlugin Fault inited")},this}),L4G.registerModule("L4G.ProgressInfo",function(e){var t=this;t._processStatus=function(e,i){switch(i.status){case"progress":if(i.action)switch(i.action){case"repair":t._tryToSetState(e,e[0].state.repair);break;case"update":t._tryToSetState(e,e[0].state.updateRequired);break;default:t._tryToSetState(e,e[0].state.notInstalled)}if(t._tryToSetState(e,e[0].state.progress),n(i,e),"true"==i.info.checking&&!i.action){t._tryToSetState(e,e[0].state.prepare);break}break;case"finished":if(i.action)switch(i.action){case"repair":t._tryToSetState(e,e[0].state.repairFinished);break;case"install":t._tryToSetState(e,e[0].state.installFinished);break;case"update":t._tryToSetState(e,e[0].state.updateFinished)}break;case"cancelling":t._tryToSetState(e,e[0].state.prepare);break;case"paused":if(i.action)switch(i.action){case"repair":t._tryToSetState(e,e[0].state.repair);break;case"update":t._tryToSetState(e,e[0].state.updateRequired);break;default:t._tryToSetState(e,e[0].state.notInstalled)}t._tryToSetState(e,e[0].state.paused),n(i,e)}};var n=function(e,t){for(var n in t)t[n].updateProgress(e.info.progress,e.info.downloaded,e.info.size,e.info.speed,!("true"!=e.info.checking))},i=function(){var e=t._getGamesCollection();for(var n in e)e[n].initCancelButton.call(e[n],a),e[n].initPauseButton.call(e[n],r),e[n].initResumeButton.call(e[n],o)},a=function(e){t.request("L4G.Application","send",{name:"cancel",data:{serviceId:e},moduleId:t.id})},r=function(e){t.request("L4G.Application","send",{name:"pause",data:{serviceId:e},moduleId:t.id})},o=function(e){t.request("L4G.Application","send",{name:"resume",data:{serviceId:e},moduleId:t.id})},s=function(e){var n=e.extra,i=t._getGamesCollection();switch(e.code){case 703:c(i);break;case 704:n.Description.search("не хватает места на диске")!=-1?c(i):n.Description.search("Ошибка извлечения")!=-1&&c(i)}},c=function(e){for(var t in e)e[t].isInState("main",e[t].state.progress)&&e[t].setState(e[t].state.error703)};return t.init=function(){t.listen("L4G.Application","in-status",t._updateStatus),L4G.signalHandlers.done(function(e){e.attachToErrorSignal(703,s),e.attachToErrorSignal(704,s)}),t.notify("started","L4G: Module ProgressInfo"),$(function(){require(["packages/che"],function(e){e.events.bind("pageTransition:success",i)}),i()})},this}),L4G.registerModule("L4G.Statistics",function(e){var t=this,n=$.extend({pingInterval:86400,pingIp:"0.0.0.0"},e);t.signals.putUserData=!0,t.signals.logError=!0,t.signals.sendStat=!0;var i,a,r=function(e,n,a){try{if("undefined"!=typeof $.tracker){if(t.notify("log",arguments),"string"==typeof a)try{a=$.parseJSON(a)}catch(r){a={}}if("string"==typeof a.data)try{a.data=$.parseJSON(a.data)}catch(r){a.data={}}a.data.errorCode&&a.data.errorCode.indexOf(">> code")>-1&&(a.type="l4g-code"),i&&(a.master_account_id=i),$.tracker("log",a.type,a.data)}}catch(r){window.console&&window.console.warn(r)}},o=function(){a=window.setInterval(function(e){t.request("L4G.Application","getPingStat",{ip:e})},1e3*n.pingInterval,n.pingIp)},s=function(e){try{$.tracker&&$.tracker("deanonymizeAuid",e)}catch(t){window.console&&window.console.warn(t)}};return t.init=function(){"undefined"==typeof $.tracker&&t.notify("warning","Tracker plugin not found."),t.onRequest("putUserData",function(e,n,a){try{a.user.auth?(i!=a.user.id&&s(a.user.id),i=a.user.id):i=null,t.request("L4G.Application","out-getPCSpecStat")}catch(r){i=null,t.notify("error","Invalid UserData object")}}),t.request("L4G.User","getUserData",{callbackSignal:"putUserData"}),t.listen("L4G.Application","in-sendStat",r),t.onRequest("logError",function(e,n,i){t.request("L4G.Application","out-logError",i)}),require(["packages/che"],function(e){e.events.bind("unhandledL4GError",function(e){t.request("L4G.Application","out-logError",e)})}),o(),t.notify("started")},this}),L4G.registerModule("L4G.Tuning",function(e){var t=this;t.signals["start-intercept-install-dir"]=!0,t.signals["finish-intercept-install-dir"]=!0;var n=0,i=!1;t._processStatus=function(e,n){"undefined"!=typeof n.configurable&&"true"==n.configurable&&t._tryToSetState(e,e[0].state.configurable)};var a=function(e){e&&(e.clickFlipButton(),t.request("L4G.Application","send",{name:"repair",data:{serviceId:e.getServiceId(),extendedStatus:"full",isFullUpdate:!0},moduleId:t.id}),t._tryToSetState([e],e.state.repair),n=0,i=!1)},r=function(e,r,o){if(n){var s=o.path.replace(/\\/g,"/");t.request("L4G.Application","send",{name:"changeDefaultInstallDir",data:{serviceId:n,value:s},moduleId:t.id}),setTimeout(function(){i&&a(i)},1e3),t.notify("finish-intercept-install-dir")}},o=function(e,i,a){if(n){var r=a.path.replace(/\\\\/g,"\\"),o=FOURGE.utils.striptags(FOURGE.GameData.getGame(n).name);t.request("L4G.Application","send",{name:"browseDir",data:{path:r,caption:o,serviceId:n},moduleId:t.id})}},s=function(e){t.notify("start-intercept-install-dir"),i=e,n=e.getServiceId(),t.request("L4G.Application","send",{name:"getDefaultInstallDir",data:{serviceId:e.getServiceId()},moduleId:t.id})},c=function(e){t.request("L4G.Application","send",{name:"configure",data:{serviceId:e},moduleId:t.id})},l=function(e){a(e)},d=function(){$.each(t._getGamesCollection(),function(){this.initConfigureButton.call(this,c),this.initRepairButton.call(this,l),this.initChangePathButton.call(this,s),this.initChangePasswordButtons()})};return t.init=function(){$(document).ready(function(){d(),require(["packages/che"],function(e){e.events.bind("pageTransition:success",d)})}),t.listen("L4G.Application","in-setInstallDir",r),t.listen("L4G.Application","in-setDefaultInstallDir",o),t.listen("L4G.Application","in-status",t._updateStatus),t.notify("started")},this}),L4G.registerModule("L4G.UpdateApplication",function(e){function t(){window.A4G&&window.A4G.updateApplication()}var n=this;$.extend({needUpdateServiceVersion:!1,needUpdatePluginVersion:!1,needUpdateTrayVersion:!1},e);return n.init=function(){n.request("L4G.Application","started"),L4G.signalHandlers.done(function(e){e.attachToErrorSignal(720,t)}),n.notify("started","L4G: Module UpdateApplication")},this}),require(["packages/jquery","packages/che","packages/intercom"],function(e,t,n){L4G.registerModule("L4G.User",function(i){"use strict";var a=this,r=FOURGE.UserData,o=!1,s=[];a.signals.getUserData={canBeRequested:!0,active:!1},a.signals.getLastUserData={canBeRequested:!0,active:!1},a.signals.UserData=!0,a.signals.guest=!0,a.signals.auth=!0;var c=function(e,t,n){"undefined"!=typeof n.callbackSignal&&("undefined"==r.user||"undefined"!=typeof n.cache&&!n.cache?u(e,n.callbackSignal):a.request(e,n.callbackSignal,r))},l=function(e,t,n){n.cache=!1,c(e,t,n)},d=function(){p(),a.enableSignal("getUserData"),a.notify("UserData",r),a.notify("log","L4G.User: received user data from server"),e.each(s,function(e,t){a.request(t.callerModuleId,t.signalName,r)}),s=[],o=!1},u=function(e,t){"undefined"!=typeof e&&s.push({callerModuleId:e,signalName:t}),o||(o=!0,FOURGE.UserData.requestData())},p=function(){var e=r.user.isAuthed();a.notify(e?"auth":"guest",{auth:!!e})},f=function(){var t,n;a.listen("L4G.User","auth",function(){t&&window.clearInterval(t),t=window.setInterval(function(){(_(e.cookie("inn-user")).isNull()||_(e.cookie("inn-user-p")).isNull())&&(n=!0,FOURGE.UserData.requestData(!0).done(function(){n=!1}))},5e3)}),a.listen("L4G.User","guest",function(){t&&(t=window.clearInterval(t),FOURGE.utils.resetUser())})};return a.init=function(){r=FOURGE.UserData,FOURGE.UserData.onUpdate(d),FOURGE.UserData.requestData(),a.notify("started"),a.enableSignal("getLastUserData"),a.onRequest("getUserData",c),a.onRequest("getLastUserData",l),f(),e(function(){if(r&&r.user){var e=!r.user.isAuthed(),i=n.getInstance();i.emit("4g-auth-notice",{userIsGuest:e}),i.on("4g-auth-notice",function(t){t.userIsGuest!=e&&(t.userIsGuest||window.location.reload(),e=t.userIsGuest)}),t.events.bind("pageTransition:success",p)}})},this})}),window.FOURGE.oGameCollection=new function(){var e=this,t=[],n={};this.addItem=function(e){t.push(e),n[e.getServiceId()]||(n[e.getServiceId()]=[]),n[e.getServiceId()].push(e)},this.getItemsById=function(e){return void 0!=n[e]?n[e]:[]},this.getItems=function(){return 0===_(t).size()&&this.updateItemsList(),t},this.updateItemsList=function(){$(".jsGameItem").each(function(){var t=!0,n=e.getItemsById($(this).data("service-id"));if("undefined"!=n)for(var i=0;i<n.length;i++)n[i].checkIfThisObject(this)&&(t=!1);if(t){var a=$(this);e.addItem(new window.oGameItem(a.data("service-id"),a.hasClass("jsServiceControl")?a:a.find(".jsServiceControl"),a.hasClass("jsServiceControl")?$():a.find(".jsServiceTuning"))),$(document).trigger("game-collection-update",[$(this).data("service-id")])}})}},window.oGameCollection=window.FOURGE.oGameCollection,window.FOURGE.oGameItem=function(e,t,n){var i=this,a=e,r=t,o=n,s={main:!1,install:!1,update:!1,play:!1,maintenance:!1,repair:!1,tuning:!1},c=function(e){switch(e){case"main":return r;case"tuning":return o;default:return s[e]||(s[e]=$(i._DOMSelectors[e].container,r)),s[e]}},l=function(e){return i.isInState("main",i.state.notInstalled)?e?"install":c("install"):i.isInState("main",i.state.repair)?e?"repair":c("repair"):i.isInState("main",i.state.updateRequired)?e?"updateRequired":c("updateRequired"):e?"main":c("main")},d=function(e,t){t?c("main").addClass(e):c("main").removeClass(e)},u=function(){R(),c("main").removeClass(i._DOMSelectors.main.modifiers.installed).removeClass(i._DOMSelectors.main.modifiers.updateRequired).removeClass(i._DOMSelectors.main.modifiers.fullUpdateRequired).removeClass(i._DOMSelectors.main.modifiers.paused).removeClass(i._DOMSelectors.main.modifiers.progress).addClass(i._DOMSelectors.main.modifiers.notInstalled)},p=function(){c("main").removeClass(i._DOMSelectors.main.modifiers.updateRequired).removeClass(i._DOMSelectors.main.modifiers.notInstalled).removeClass(i._DOMSelectors.main.modifiers.fullUpdateRequired).removeClass(i._DOMSelectors.main.modifiers.progress).removeClass(i._DOMSelectors.main.modifiers.repair).addClass(i._DOMSelectors.main.modifiers.installed)},f=function(){R(),c("main").removeClass(i._DOMSelectors.main.modifiers.installed).removeClass(i._DOMSelectors.main.modifiers.notInstalled).removeClass(i._DOMSelectors.main.modifiers.fullUpdateRequired).removeClass(i._DOMSelectors.main.modifiers.progress).removeClass(i._DOMSelectors.main.modifiers.repair).addClass(i._DOMSelectors.main.modifiers.updateRequired)},g=function(){f(),c("main").addClass(i._DOMSelectors.main.modifiers.fullUpdateRequired)},m=function(e){R(),d(i._DOMSelectors.main.modifiers.maintenance,e)},h=function(e){d(i._DOMSelectors.main.modifiers.dialogCancel,e)},v=function(e){e?c("main").add(c("tuning")).addClass(i._DOMSelectors.main.modifiers.auth).removeClass(i._DOMSelectors.main.modifiers.guest):c("main").add(c("tuning")).addClass(i._DOMSelectors.main.modifiers.guest).removeClass(i._DOMSelectors.main.modifiers.auth)},S=function(e){e?c("main").add(c("tuning")).addClass(i._DOMSelectors.main.modifiers.noApprovedAccount):c("main").add(c("tuning")).removeClass(i._DOMSelectors.main.modifiers.noApprovedAccount)},y=function(e){e?c("main").addClass(i._DOMSelectors.main.modifiers.needAcceptLicence):c("main").removeClass(i._DOMSelectors.main.modifiers.needAcceptLicence)},D=function(e){A(),R(),c("main").addClass(i._DOMSelectors.main.modifiers.pluginNeedUpdate)},b=function(e){R(),e?c("main").addClass(i._DOMSelectors.main.modifiers.pluginFault):c("main").removeClass(i._DOMSelectors.main.modifiers.pluginFault)},_=function(){R(),c("main").removeClass(i._DOMSelectors.main.modifiers.prepare).addClass(i._DOMSelectors.main.modifiers.progress).addClass(i._DOMSelectors.main.modifiers.paused)},I=function(){R(),E(),c("main").removeClass(i._DOMSelectors.main.modifiers.paused).removeClass(i._DOMSelectors.main.modifiers.prepare).addClass(i._DOMSelectors.main.modifiers.progress)},w=function(){R(),c("main").addClass(i._DOMSelectors.main.modifiers.prepare),i.updateProgressBarWidth(0)},G=function(){c("main").addClass(i._DOMSelectors.main.modifiers.repair).removeClass(i._DOMSelectors.main.modifiers.installed).removeClass(i._DOMSelectors.main.modifiers.updateRequired),c("tuning").addClass(i._DOMSelectors.tuning.modifiers.repair),i.updateProgressBarWidth(0)},C=function(e){e?c("main").addClass(i._DOMSelectors.main.modifiers.repairFinished):c("main").removeClass(i._DOMSelectors.main.modifiers.repairFinished)},O=function(e){e?c("main").addClass(i._DOMSelectors.main.modifiers.updateFinished):c("main").removeClass(i._DOMSelectors.main.modifiers.updateFinished)},k=function(e){e?c("main").addClass(i._DOMSelectors.main.modifiers.installFinished):c("main").removeClass(i._DOMSelectors.main.modifiers.installFinished)},U=function(){c("tuning").addClass(i._DOMSelectors.tuning.modifiers.configurable)},L=function(){c("main").addClass(i._DOMSelectors.main.modifiers.error703)},R=function(){F(),c("main").removeClass(i._DOMSelectors.main.modifiers.checking)},E=function(){c("main").removeClass(i._DOMSelectors.main.modifiers.error703)},F=function(){c("main").removeClass(i._DOMSelectors.main.modifiers.repairFinished).removeClass(i._DOMSelectors.main.modifiers.installFinished).removeClass(i._DOMSelectors.main.modifiers.updateFinished)},A=function(){c("main").removeClass(i._DOMSelectors.main.modifiers.pluginNeedUpdate).removeClass(i._DOMSelectors.main.modifiers.pluginFault).removeClass(i._DOMSelectors.main.modifiers.notInstalled).removeClass(i._DOMSelectors.main.modifiers.installed).removeClass(i._DOMSelectors.main.modifiers.updateRequired).removeClass(i._DOMSelectors.main.modifiers.fullUpdateRequired)};this.getContainer=c,this.checkIfThisObject=function(e){return c("main")[0]==e},this.isInState=function(e,t){return c(e).hasClass(t)},this.updateInitialDownloadSize=function(e){},this.updateProgress=function(e,t,n,a,r){var o=l();r&&!i.isInState("main",i.state.checking)?c("main").addClass(i._DOMSelectors.main.modifiers.checking):i.isInState("main",i.state.checking)&&c("main").removeClass(i._DOMSelectors.main.modifiers.checking),$(i._DOMSelectors.progress.value,o).html(Math.round(e)+"%"),i.updateProgressBarWidth(e)},this.updateProgressBarWidth=function(e){$(i._DOMSelectors.progress.fillingBar,l()).width(e+"%")},this.initDownloadButton=function(e){if(!e)return!1;var t=c("main").find(i._DOMSelectors.pluginFault.btnDownload);return!t.data("download-inited")&&void t.click(function(e){e.preventDefault(),e.stopPropagation(),window.A4G?window.A4G.download({serviceId:t.closest("form").data("id")}):t.closest("form").submit()}).data("download-inited",!0)},this.initUpdatePluginButton=function(){var e=c("main").find(i._DOMSelectors.pluginNeedUpdate.container);return!e.data("download-update-inited")&&void e.submit(function(e){$(this);return!window.A4G||(e.preventDefault(),e.stopPropagation(),window.A4G.updateApplication(),!1)}).data("download-update-inited",!0)},this.initPlayButton=function(e){c("play").each(function(){$(this).data("play-inited")||($(this).submit(function(t){t.preventDefault(),e(i.getServiceId(),$(this).data("service-account-id"))}),$(this).data("play-inited",!0))})},this.initUpdateButton=function(e){return!c("updateRequired").data("update-click-inited")&&(c("updateRequired").submit(function(t){t.preventDefault(),e(i.getServiceId(),i.isInState("main",i.state.fullUpdateRequired))}),void c("updateRequired").data("update-click-inited",!0))},this.initInstallButton=function(e){return!c("install").data("install-click-inited")&&(c("install").find(i._DOMSelectors.install.btnInstall).on("click",function(e){e.preventDefault(),e.stopPropagation(),c("install").submit()}),c("install").submit(function(t){t.preventDefault(),t.stopPropagation(),i.isInState("main",i.state.pluginNeedUpdate)&&window.A4G?window.A4G.updateApplication():e(i.getServiceId())}),void c("install").data("install-click-inited",!0))},this.initCancelButton=function(e){if(c("main").data("btn-cancel-inited"))return!1;var t=c("main").find(i._DOMSelectors.progress.btnCancel),n=c("main").find(i._DOMSelectors.progress.btnCancelConfirm),r=c("main").find(i._DOMSelectors.progress.btnCancelReject);t.click(function(e){e.stopImmediatePropagation(),e.preventDefault(),i.setState(i.state.dialogCancelShow)}),r.click(function(e){e.stopImmediatePropagation(),e.preventDefault(),i.setState(i.state.dialogCancelHide)}),n.click(function(t){t.stopImmediatePropagation(),t.preventDefault(),e(a),i.setState(i.state.dialogCancelHide)}),c("main").data("btn-cancel-inited",!0)},this.initPauseButton=function(e){if(c("main").data("btn-pause-inited"))return!1;var t=c("main").find(i._DOMSelectors.progress.btnPause);c("main").find(i._DOMSelectors.progress.btnResume);t.click(function(t){t.stopImmediatePropagation(),t.preventDefault(),e(a)}),c("main").data("btn-pause-inited",!0)},this.initResumeButton=function(e){if(c("main").data("btn-resume-inited"))return!1;var t=(c("main").find(i._DOMSelectors.progress.btnPause),c("main").find(i._DOMSelectors.progress.btnResume));t.click(function(t){t.stopImmediatePropagation(),t.preventDefault(),e(a)}),c("main").data("btn-resume-inited",!0)},this.initChangePathButton=function(e){c("tuning").data("tuning-change-path-inited")||(c("tuning").find(i._DOMSelectors.tuning.btnChangeDefaultPath).click(function(t){t.preventDefault(),t.stopPropagation(),e(i)}),c("tuning").data("tuning-change-path-inited",!0))},this.initConfigureButton=function(e){c("tuning").data("tuning-configure-inited")||(c("tuning").find(i._DOMSelectors.tuning.btnConfigure).click(function(t){t.preventDefault(),t.stopPropagation(),e(i.getServiceId())}),c("tuning").data("tuning-configure-inited",!0))},this.initRepairButton=function(e){c("tuning").data("tuning-repair-inited")||(c("tuning").find(i._DOMSelectors.tuning.btnRepair).click(function(t){t.preventDefault(),t.stopPropagation(),i.clickFlipButton(),e(i)}),c("tuning").data("tuning-repair-inited",!0))},this.initChangePasswordButtons=function(){c("tuning").data("tuning-set-password-inited")||(c("tuning").find("form.mPasswordSettings").find(".bPseudoButtonLink").each(function(e,t){$(this).attr("href",$(this).attr("href")+"&serviceAccountId="+$(this).closest("form").data("service-account-id"))}),c("tuning").data("tuning-set-password-inited",!0))},this.clickFlipButton=function(){c("tuning").is(":visible")?c("tuning").find(i._DOMSelectors.tuning.panelFaceFlip).trigger("click"):c("main").find(i._DOMSelectors.main.panelBackFlip).trigger("click")},this.state={pluginNeedUpdate:this._DOMSelectors.main.modifiers.pluginNeedUpdate,notInstalled:this._DOMSelectors.main.modifiers.notInstalled,installed:this._DOMSelectors.main.modifiers.installed,updateRequired:this._DOMSelectors.main.modifiers.updateRequired,fullUpdateRequired:this._DOMSelectors.main.modifiers.fullUpdateRequired,maintenanceOn:this._DOMSelectors.main.modifiers.maintenance,maintenanceOff:this._DOMSelectors.main.modifiers.maintenance+"_off",auth:this._DOMSelectors.main.modifiers.auth,guest:this._DOMSelectors.main.modifiers.guest,noApprovedAccount:this._DOMSelectors.main.modifiers.noApprovedAccount,noApprovedAccountOff:this._DOMSelectors.main.modifiers.noApprovedAccount+"_off",pluginFault:this._DOMSelectors.main.modifiers.pluginFault,pluginNormal:this._DOMSelectors.main.modifiers.pluginFault+"_off",paused:this._DOMSelectors.main.modifiers.paused,progress:this._DOMSelectors.main.modifiers.progress,prepare:this._DOMSelectors.main.modifiers.prepare,checking:this._DOMSelectors.main.modifiers.checking,checkingOff:this._DOMSelectors.main.modifiers.checking+"_off",configurable:this._DOMSelectors.tuning.modifiers.configurable,dialogCancelShow:this._DOMSelectors.main.modifiers.dialogCancel,dialogCancelHide:this._DOMSelectors.main.modifiers.dialogCancel+"_off",repair:this._DOMSelectors.main.modifiers.repair,repairFinished:this._DOMSelectors.main.modifiers.repair+"_finished",installFinished:this._DOMSelectors.main.modifiers.notInstalled+"_finished",updateFinished:this._DOMSelectors.main.modifiers.updateRequired+"_finished",needAcceptLicence:this._DOMSelectors.main.modifiers.needAcceptLicence,noNeedAcceptLicence:this._DOMSelectors.main.modifiers.needAcceptLicence+"_off",error703:this._DOMSelectors.main.modifiers.error703},this.getServiceId=function(){return a},this.setState=function(e){switch(e){case this.state.pluginNeedUpdate:D();break;case this.state.notInstalled:u();break;case this.state.installed:p();break;case this.state.updateRequired:f();break;case this.state.fullUpdateRequired:g();break;case this.state.maintenanceOn:m(!0);break;case this.state.maintenanceOff:m(!1);break;case this.state.auth:v(!0);break;case this.state.guest:v(!1);break;case this.state.noApprovedAccount:S(!0);break;case this.state.noApprovedAccountOff:S(!1);break;case this.state.pluginFault:b(!0);break;case this.state.pluginNormal:b(!1);break;case this.state.paused:_();break;case this.state.progress:I();break;case this.state.prepare:w();break;case this.state.repair:G();break;case this.state.configurable:
U();break;case this.state.dialogCancelShow:h(!0);break;case this.state.dialogCancelHide:h(!1);break;case this.state.repairFinished:C(!0);break;case this.state.installFinished:k(!0);break;case this.state.updateFinished:O(!0);break;case this.state.needAcceptLicence:y(!0);break;case this.state.noNeedAcceptLicence:y(!1);break;case this.state.error703:L()}}},window.oGameItem=window.FOURGE.oGameItem,window.FOURGE.oGameItem.prototype={_DOMSelectors:{metaContainer:".jsServiceControl",main:{panelBackFlip:".jsGamePanelBackFlip",modifiers:{pluginNeedUpdate:"mPluginNeedUpdate",notInstalled:"mNotInstalled",installed:"mInstalled",updateRequired:"mUpdateRequired",fullUpdateRequired:"mFullUpdateRequired",maintenance:"mMaintenance",auth:"mAuth",guest:"mNotAuth",noApprovedAccount:"mNoApprovedAccount",needAcceptLicence:"mNeedLicenceAccept",repair:"mRepair",pluginFault:"mPluginFault",prepare:"mType_prepare",checking:"mType_checking",progress:"mInProgress",paused:"mType_pause",cancelling:"mCancelling",dialogCancel:"mType_cancel",dialogError701:"mType_error701ServiceNotSupported",dialogError702:"mType_error702NoLauncherFile",error703:"mType_error703DiskFull",dialogError704:"mType_error704InternalError",dialogError705:"mType_error705InternalError",dialogError706:"mType_error706TorrentWorking",error:"mSomeErrors",errorCheckbox:"mErrorCheckbox",repairFinished:"mRepairFinished",installFinished:"mInstallFinished",updateFinished:"mUpdateFinished"}},install:{container:".jsServiceInstall",btnInstall:".jsBtnServiceInstall",icon:".jsServiceIcon",description:".jsServiceDescription",modifiers:{notInstalled:"mNotInstalled",notFind:"mServiceNotFind",prepare:"mPrepare",progress:"mInProgress",paused:"mOnPause",cancelling:"mCancelling",error:"mSomeErrors",error_720:"mError_720",error_810:"mError_810",errorCheckbox:"mErrorCheckbox"},chooseDir:{container:".jsFolderChooseForm",icon:".jsFolderChooseIcon",title:".jsFolderChooseTitle",description:".jsFolderChooseDescription",btnBrowse:".jsBtnFolderChoose",pathInput:".jsPathInput",chbAcceptLicence:".jsChbAcceptLicence",btnBegin:".jsBtnBeginInstall"}},updateRequired:{container:".jsServiceUpdate",btnUpdate:".jsBtnServiceUpdate",modifiers:{updateRequired:"mUpdateRequired",prepare:"mPrepare",progress:"mInProgress",paused:"mOnPause",cancelling:"mCancelling",error:"mSomeErrors",error_720:"mError_720",error_810:"mError_810",errorCheckbox:"mErrorCheckbox"}},repair:{container:".jsServiceRepair"},play:{metaContainer:".jsServiceControl",container:".jsServicePlay",btnPlay:".jsBtnServicePlay",tabSwitcher:".jsTabSwitcherItem",banCount:".jsBanCount",lastAuthTime:".jsLastAuthTime",lastAuthNick:".jsLastAuthNick",modifiers:{oneAccount:"mSection_playSingle",fewAccounts:"mSection_playFew",manyAccounts:"mSection_playMany",ban:"mBanned",lastAuth:"mLastAuth",withPassword:"mWithPassword",premium:"mGameAccountImprove",mobileRequired:"mMobileRequired",emailRequired:"mEmailRequired",countryRequired:"mCountryRequired",betaRequired:"mActivationCodeRequired",error_720:"mError_720",error_810:"mError_810"}},pluginFault:{container:".jsServiceNoPlugin",btnDownload:".jsBtnServiceNoPlugin"},pluginNeedUpdate:{container:".jsServicePluginNeedUpdate",btnDownload:".jsBtnPluginNeedUpdate"},progress:{metaContainer:".jsServiceControl",container:".jsProgressBlock",possibleContainers:".jsServiceInstall, .jsServiceUpdate, .jsServiceRepair",value:".jsServiceProgressValue",fillingBar:".jsServiceProgressBar",explanation:".jsProgressExplanation",btnPause:".jsBtnServicePause",btnResume:".jsBtnServiceResume",btnCancel:".jsBtnServiceCancel",btnCancelConfirm:".bSmallDialog.mType_cancel .bSmallDialog__eConfirm",btnCancelReject:".bSmallDialog.mType_cancel .bSmallDialog__eReject",modifiers:{parentProgress:"mInProgress",paused:"mType_pause",prepare:"mType_prepare"}},tuning:{container:".jsServiceTuning",btnChangeDefaultPath:".jsBtnChangeDefaultPath",btnRepair:".jsBtnServiceRepair",btnConfigure:".jsBtnServiceConfigure",panelFaceFlip:".jsGamePanelFaceFlip",modifiers:{configurable:"mConfigurable",repair:"mRepair"}}},getSelectors:function(){return this._DOMSelectors}},$(function(){$(document).ready(function(){require(["packages/che"],function(e){e.events.bind("pageTransition:success",window.oGameCollection.updateItemsList)})})}),function(){var e,t,n=".GlobalFixedScroll",i="fixed-element-appear"+n,a="fixed-element-disappear"+n,r="left",o=function(t,n){if(!n)return!1;var i=$(n);e.elements[n]={$object:i,initial:parseInt(i.css(r),10)||0},c()},s=function(t,n){return!!n&&(delete e.elements[n],void c())},c=function(){var n,i=window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft;if(i===e.prevScrollLeft)return!0;for(var a in t)n=t[a],n.$object.css(r,n.initial-i);e.prevScrollLeft=i};"object"!=typeof window.GlobalFixedScroll&&(window.GlobalFixedScroll={elements:{},prevScrollLeft:0}),e=window.GlobalFixedScroll,t=e.elements,$(document).off(n).on(i,o).on(a,s),$(window).scroll(c)}(),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=window,null==e.FOURGE&&(e.FOURGE={}),e.FOURGE.FormValidation=function(){function e(){}return e.initForm=function(e){},e}(),e.FOURGE.FormCustomUI=function(){function e(){}return e.initForm=function(e){},e}(),e.FOURGE.preloadImages=function(e){var t,n;return n=function(){var n,i,a;for(a=[],n=0,i=e.length;n<i;n++)t=e[n],a.push($("<img>").attr("src",t));return a}()},e.FOURGE.stopPropagation=function(e){if(e.cancelBubble=!0,e.stopPropagation)return e.stopPropagation()},e.FOURGE.UIDraggable=function(){function e(e,t){return this.$target=e,this.options=null!=t?t:{},this.$target instanceof jQuery?this instanceof FOURGE.UIDraggable?(this.options=$.extend(!0,{},this._defaults(),this.options),void this.init()):new FOURGE.UIDraggable(this.$target,this.options):this}return e.prototype.init=function(){return null!=this.$target.data("inn.UIDraggable")&&this.$target.data("inn.UIDraggable")!==this?(this.$target.data("inn.UIDraggable").dispose(),this.$target.data("inn.UIDraggable",this)):this.$target.data("inn.UIDraggable",this),this.attachEvents(),this},e.prototype.attachEvents=function(){return this.options.holder.on("mousedown.UIDraggable",function(e){return function(t){var n;if(!e._locked)return n=$(t.currentTarget),e.$target.css("position","absolute"),e._moveable=!0,e._lastPosition={x:t.pageX,y:t.pageY},e._dragStart=!1}}(this)),this.options.cursorMovingContext.on("mousemove.UIDraggable",function(e){return function(t){var n;if(e._moveable&&!e._locked)return e._dragStart||(e.$target.trigger("UIDraggable:dragstart"),e._dragStart=!0),n=e._calculatePositions(e.$target,e.options.elementMovingContext,t),null!=n.y&&e.$target.css({top:n.y+"px"}),null!=n.x?e.$target.css({left:n.x+"px"}):void 0}}(this)),this.options.cursorMovingContext.on("mouseup.UIDraggable",function(e){return function(t){if(e._moveable&&!e._locked)return e._moveable=!1,e.$target.trigger("UIDraggable:dragstop"),e.options.resetOnDrop?e.$target.css({position:"",top:"",left:""}):void 0}}(this)),this},e.prototype.dispose=function(){return this.options.holder.off("mousedown.UIDraggable"),this.options.cursorMovingContext.off("mousemove.UIDraggable"),this.options.cursorMovingContext.off("mouseup.UIDraggable"),this.$target.css({position:"",top:"",left:""}),this._lastPosition={x:0,y:0},this._moveable=!1,this._locked=!1,this},e.prototype.lock=function(){return this._locked=!0,this},e.prototype.unlock=function(){return this._locked=!1,this},e.prototype._calculatePositions=function(e,n,i){var a,r,o,s,c,l,d,u,p,f,g,m;return g=e.position(),f=e.offset(),p={width:e.width(),height:e.height()},d=n.position(),l=n.offset(),c={width:n.outerWidth(),height:n.outerHeight()},o={x:i.pageX-this._lastPosition.x,y:i.pageY-this._lastPosition.y},u={left:l.left,top:l.top,right:l.left+c.width,bottom:l.top+c.height},m={left:f.left+o.x,top:f.top+o.y,right:f.left+p.width+o.x,bottom:f.top+p.height+o.y},s={},t.call(this.options.directions,"y")>=0&&(a=m.top-u.top,r=m.bottom-u.bottom,a<0?(s.y=g.top-a+o.y,this._lastPosition.y=i.pageY-a):r>0?(s.y=g.top-r+o.y,this._lastPosition.y=i.pageY-r):(s.y=g.top+o.y,this._lastPosition.y=i.pageY)),t.call(this.options.directions,"x")>=0&&(a=m.left-u.left,r=m.right-u.right,a<0?(s.x=g.left-a+o.x,this._lastPosition.x=i.pageX-a):r>0?(s.x=g.left-r+o.x,this._lastPosition.x=i.pageX-r):(s.x=g.left+o.x,this._lastPosition.x=i.pageX)),s},e.prototype._defaults=function(){var e;return{holder:null!=(e=this.options.holder)?e:this.$target,cursorMovingContext:$(document.body),elementMovingContext:$(document.body),directions:"xy",resetOnDrop:!1}},e.prototype._locked=!1,e.prototype._moveable=!1,e.prototype._lastPosition={x:0,y:0},e.prototype._dragStart=!1,e}()}.call(this),require(["packages/jquery"],function(e){e(document).trigger("get-l4g-model-status")});