(function(){var n=[].indexOf||function(n){for(var t=0,e=this.length;t<e;t++)if(t in this&&this[t]===n)return t;return-1};define(function(require,exports,t){var e,a,r,i,o,c,u,l,f,d;return e=require("packages/jquery"),r=require("packages/l4gApp"),a=require("streams/events"),o=require("global/yandex-metrika"),u=function(n,t){var e;return e=function(){if(null!=t?t.apply(this,arguments):void 0)return r.backend.off(n,e)},r.backend.on(n,e)},c=function(n){return JSON.parse(n||"{}")},i=function(n){var t;return r.backend.connected()?n():(t=function(){return r.backend.off("connect",t),n()},r.backend.on("connect",t))},f=function(){var n,t,e,i,o,u;return i="piwik-last-track-time",t=3e5,e=0,o=0,u=function(r){var u,l;if(r=c(r),l=r.name,u=r.data,"track"===l)return window.localStorage.setItem(i,o),(null!=u?u.length:void 0)&&a.log("@l4g-application","tracks",u),e||(e=setTimeout(n,t)),!0},n=function(){return o=+window.localStorage.getItem(i),e=0,r.backend.send("getTrackingData",{offset:o}),o=Date.now()/1e3|0},r.backend.on("message",u),n()},d=null!=(l=document.body)?l.getAttribute("data-user-id"):void 0,r.backend.on("stat",function(n){return o.reachGoal("l4g-application",{action:n,userId:d}),a.log("@l4g-application","info",n)}),i(function(){var t;return t=function(t){var e,a;if(t=c(t),a=t.name,e=t.data,"setFeature"===a)return n.call(e.features,"getTrackingData")>=0&&f(),!0},u("message",t),r.backend.send("getFeature")})})}).call(this);
//# sourceMappingURL=l4g-stat.js.map
