define(["packages/lodash"],function(t){var n,e,i;if(function(t){function r(t,n){return w.call(t,n)}function o(t,n){var e,i,r,o,c,s,a,u,l,f,p,h=n&&n.split("/"),b=m.map,d=b&&b["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=t.split("/"),c=t.length-1,m.nodeIdCompat&&_.test(t[c])&&(t[c]=t[c].replace(_,"")),t=h.concat(t),l=0;l<t.length;l+=1)if(p=t[l],"."===p)t.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||d)&&b){for(e=t.split("/"),l=e.length;l>0;l-=1){if(i=e.slice(0,l).join("/"),h)for(f=h.length;f>0;f-=1)if(r=b[h.slice(0,f).join("/")],r&&(r=r[i])){o=r,s=l;break}if(o)break;!a&&d&&d[i]&&(a=d[i],u=l)}!o&&a&&(o=a,s=u),o&&(e.splice(0,s,o),t=e.join("/"))}return t}function c(n,e){return function(){return h.apply(t,x.call(arguments,0).concat([n,e]))}}function s(t){return function(n){return o(n,t)}}function a(t){return function(n){g[t]=n}}function u(n){if(r(y,n)){var e=y[n];delete y[n],v[n]=!0,p.apply(t,e)}if(!r(g,n)&&!r(v,n))throw new Error("No "+n);return g[n]}function l(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function f(t){return function(){return m&&m.config&&m.config[t]||{}}}var p,h,b,d,g={},y={},m={},v={},w=Object.prototype.hasOwnProperty,x=[].slice,_=/\.js$/;b=function(t,n){var e,i=l(t),r=i[0];return t=i[1],r&&(r=o(r,n),e=u(r)),r?t=e&&e.normalize?e.normalize(t,s(n)):o(t,n):(t=o(t,n),i=l(t),r=i[0],t=i[1],r&&(e=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:e}},d={require:function(t){return c(t)},exports:function(t){var n=g[t];return"undefined"!=typeof n?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},p=function(n,e,i,o){var s,l,f,p,h,m,w=[],x=typeof i;if(o=o||n,"undefined"===x||"function"===x){for(e=!e.length&&i.length?["require","exports","module"]:e,h=0;h<e.length;h+=1)if(p=b(e[h],o),l=p.f,"require"===l)w[h]=d.require(n);else if("exports"===l)w[h]=d.exports(n),m=!0;else if("module"===l)s=w[h]=d.module(n);else if(r(g,l)||r(y,l)||r(v,l))w[h]=u(l);else{if(!p.p)throw new Error(n+" missing "+l);p.p.load(p.n,c(o,!0),a(l),{}),w[h]=g[l]}f=i?i.apply(g[n],w):void 0,n&&(s&&s.exports!==t&&s.exports!==g[n]?g[n]=s.exports:f===t&&m||(g[n]=f))}else n&&(g[n]=i)},n=e=h=function(n,e,i,r,o){if("string"==typeof n)return d[n]?d[n](e):u(b(n,e).f);if(!n.splice){if(m=n,m.deps&&h(m.deps,m.callback),!e)return;e.splice?(n=e,e=i,i=null):n=t}return e=e||function(){},"function"==typeof i&&(i=r,r=o),r?p(t,n,e,i):setTimeout(function(){p(t,n,e,i)},4),h},h.config=function(t){return h(t)},n._defined=g,i=function(t,n,e){n.splice||(e=n,n=[]),r(g,t)||r(y,t)||(y[t]=[t,n,e])},i.amd={jQuery:!0}}(),i("node_modules/almond/almond",function(){}),function(t,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof i&&i.amd?i("conduitjs",[],n(t)):t.Conduit=n(t)}(this,function(){function t(t){if("function"!=typeof t.target)throw new Error("You can only make functions into Conduits.");var n={pre:t.pre||[],post:t.post||[],all:[]},e=t.context,i=t.target,r={isTarget:!0,fn:t.sync?function(){var t=Array.prototype.slice.call(arguments,0),n=i.apply(e,t);return n}:function(t){var n=Array.prototype.slice.call(arguments,1);n.splice(1,1,i.apply(e,n)),t.apply(this,n)}},o=function(){n.all=n.pre.concat([r].concat(n.post))};o();var c=function(){var i,r,o=0,c=function s(){var c,a,u=Array.prototype.slice.call(arguments,0),l=o;o+=1,l<n.all.length&&(c=n.all[l],r="target"===r?"after":c.isTarget?"target":"before",t.sync?"before"===r?(a=c.fn.apply(c.context||e,u),s.apply(this,a||u)):(i=c.fn.apply(c.context||e,u)||i,s.apply(this,[i].concat(u))):c.fn.apply(c.context||e,[s].concat(u)))};return c.apply(this,arguments),i};return c.steps=function(){return n.all},c.context=function(t){return 0===arguments.length?e:void(e=t)},c.before=function(t,e){t="function"==typeof t?{fn:t}:t,e=e||{},e.prepend?n.pre.unshift(t):n.pre.push(t),o()},c.after=function(t,e){t="function"==typeof t?{fn:t}:t,e=e||{},e.prepend?n.post.unshift(t):n.post.push(t),o()},c.clear=function(){n={pre:[],post:[],all:[]},o()},c.target=function(t){return t&&(i=t),i},c}return{Sync:function(n){return n.sync=!0,t.call(this,n)},Async:function(n){return t.call(this,n)}}}),function(t,n){"object"==typeof module&&module.exports?module.exports=n(e("lodash"),e("conduitjs"),this):"function"==typeof i&&i.amd?i("postal",["lodash","conduitjs"],function(e,i){return n(e,i,t)}):t.postal=n(t._,t.Conduit,t)}(this,function(t,n,e){function r(){for(;w.length;)l.unsubscribe(w.shift())}function o(t,n){return{channel:l.configuration.SYSTEM_CHANNEL,topic:"subscription."+t,data:{event:"subscription."+t,channel:n.channel,topic:n.topic}}}function c(n){return"function"==typeof n?n:n?function(e){var i=0,r=0;return t.each(n,function(t,o){i+=1,("topic"===o&&l.configuration.resolver.compare(e.topic,n.topic)||"context"===o&&n.context===(e.callback.context&&e.callback.context()||e.context)||e[o]===n[o])&&(r+=1)}),i===r}:function(){return!0}}function s(t){var n,e=new h(t.channel||this.configuration.DEFAULT_CHANNEL,t.topic,t.callback),i=this.subscriptions[e.channel];return i||(i=this.subscriptions[e.channel]={}),n=this.subscriptions[e.channel][e.topic],n||(n=this.subscriptions[e.channel][e.topic]=[]),n.push(e),e}function a(n){++v,n.channel=n.channel||this.configuration.DEFAULT_CHANNEL,n.timeStamp=new Date,t.each(this.wireTaps,function(t){t(n.data,n,v)}),this.subscriptions[n.channel]&&t.each(this.subscriptions[n.channel],function(t){for(var e,i=0,r=t.length;r>i;)(e=t[i++])&&m(e,n)}),0===--v&&r()}function u(){for(var n,e,i,r=0,c=Array.prototype.slice.call(arguments,0);n=c.shift();){if(v)return void w.push(n);if(e=this.subscriptions[n.channel],i=e&&e[n.topic]){var s=i.length;for(r=0;s>r;){if(i[r]===n){i.splice(r,1);break}r+=1}0===i.length&&(delete e[n.topic],t.isEmpty(e)&&delete this.subscriptions[n.channel])}l.publish(o("removed",n))}}var l,f=e.postal,p=function(t){this.channel=t||l.configuration.DEFAULT_CHANNEL,this.initialize()};p.prototype.initialize=function(){var t=this.publish;this.publish=new n.Async({target:t,context:this})},p.prototype.subscribe=function(){return l.subscribe({channel:this.channel,topic:1===arguments.length?arguments[0].topic:arguments[0],callback:1===arguments.length?arguments[0].callback:arguments[1]})},p.prototype.publish=function(){var t=1===arguments.length?"[object String]"===Object.prototype.toString.call(arguments[0])?{topic:arguments[0]}:arguments[0]:{topic:arguments[0],data:arguments[1]};t.channel=this.channel,l.publish(t)};var h=function(t,n,e){if(3!==arguments.length)throw new Error("You must provide a channel, topic and callback when creating a SubscriptionDefinition instance.");if(0===n.length)throw new Error("Topics cannot be empty");this.channel=t,this.topic=n,this.subscribe(e)},b=function(){var n;return function(e){var i=!1;return t.isString(e)?(i=e===n,n=e):(i=t.isEqual(e,n),n=t.clone(e)),!i}},d=function(){var n=[];return function(e){var i=!t.any(n,function(n){return t.isObject(e)||t.isArray(e)?t.isEqual(e,n):e===n});return i&&n.push(e),i}},g={withDelay:function(n){if(t.isNaN(n))throw"Milliseconds must be a number";return{name:"withDelay",fn:function(t,e,i){setTimeout(function(){t(e,i)},n)}}},defer:function(){return this.withDelay(0)},stopAfter:function(n,e){if(t.isNaN(n)||0>=n)throw"The value provided to disposeAfter (maxCalls) must be a number greater than zero.";var i=t.after(n,e);return{name:"stopAfter",fn:function(t,n,e){i(),t(n,e)}}},withThrottle:function(n){if(t.isNaN(n))throw"Milliseconds must be a number";return{name:"withThrottle",fn:t.throttle(function(t,n,e){t(n,e)},n)}},withDebounce:function(n,e){if(t.isNaN(n))throw"Milliseconds must be a number";return{name:"debounce",fn:t.debounce(function(t,n,e){t(n,e)},n,!!e)}},withConstraint:function(n){if(!t.isFunction(n))throw"Predicate constraint must be a function";return{name:"withConstraint",fn:function(t,e,i){n.call(this,e,i)&&t.call(this,e,i)}}},distinct:function(t){t=t||{};var n=function(t){return t[0]},e=t.all?new d(n):new b(n);return{name:"distinct",fn:function(t,n,i){e(n)&&t(n,i)}}}};h.prototype={after:function(){return this.callback.after.apply(this,arguments),this},before:function(){return this.callback.before.apply(this,arguments),this},"catch":function(t){var n=this.callback.target(),e=function(){try{n.apply(this,arguments)}catch(e){t(e,arguments[0])}};return this.callback.target(e),this},defer:function(){return this.callback.before(g.defer()),this},disposeAfter:function(t){var n=this;return n.callback.before(g.stopAfter(t,function(){n.unsubscribe.call(n)})),n},distinctUntilChanged:function(){return this.callback.before(g.distinct()),this},distinct:function(){return this.callback.before(g.distinct({all:!0})),this},logError:function(){if(console){var t;t=console.warn?console.warn:console.log,this["catch"](t)}return this},once:function(){return this.disposeAfter(1),this},subscribe:function(t){return this.callback=new n.Async({target:t,context:this}),this},unsubscribe:function(){this.inactive||(this.inactive=!0,l.unsubscribe(this))},withConstraint:function(t){return this.callback.before(g.withConstraint(t)),this},withConstraints:function(t){for(;t.length;)this.callback.before(g.withConstraint(t.shift()));return this},withDebounce:function(t,n){return this.callback.before(g.withDebounce(t,n)),this},withDelay:function(t){return this.callback.before(g.withDelay(t)),this},withThrottle:function(t){return this.callback.before(g.withThrottle(t)),this},withContext:function(t){return this.callback.context(t),this}};var y={cache:{},regex:{},compare:function(n,e){var i,r,o,c=this.cache[e]&&this.cache[e][n];return"undefined"!=typeof c?c:((r=this.regex[n])||(i="^"+t.map(n.split("."),function(t){var n="";return o&&(n="#"!==o?"\\.\\b":"\\b"),n+="#"===t?"[\\s\\S]*":"*"===t?"[^.]+":t,o=t,n}).join("")+"$",r=this.regex[n]=new RegExp(i)),this.cache[e]=this.cache[e]||{},this.cache[e][n]=c=r.test(e),c)},reset:function(){this.cache={},this.regex={}}},m=function(t,n){!t.inactive&&l.configuration.resolver.compare(t.topic,n.topic)&&t.callback(n.data,n)},v=0,w=[];if(l={configuration:{resolver:y,DEFAULT_CHANNEL:"/",SYSTEM_CHANNEL:"postal"},subscriptions:{},wireTaps:[],ChannelDefinition:p,SubscriptionDefinition:h,channel:function(t){return new p(t)},addWireTap:function(t){var n=this;return n.wireTaps.push(t),function(){var e=n.wireTaps.indexOf(t);-1!==e&&n.wireTaps.splice(e,1)}},noConflict:function(){if("undefined"==typeof window||"undefined"!=typeof window&&"function"==typeof i&&i.amd)throw new Error("noConflict can only be used in browser clients which aren't using AMD modules");return e.postal=f,this},getSubscribersFor:function(n){var e=[];return t.each(this.subscriptions,function(i){t.each(i,function(i){e=e.concat(t.filter(i,c(n)))})}),e},reset:function(){this.unsubscribeFor(),this.configuration.resolver.reset(),this.subscriptions={}},unsubscribeFor:function(t){var n=[];this.subscriptions&&(n=this.getSubscribersFor(t),this.unsubscribe.apply(this,n))}},l.subscribe=new n.Sync({target:s,context:l}),l.publish=n.Async({target:a,context:l}),l.unsubscribe=new n.Sync({target:u,context:l}),l.subscribe.after(function(t){l.publish(o("created",t))}),l.subscriptions[l.configuration.SYSTEM_CHANNEL]={},l.linkChannels=function(n,e){var i=[],r=this;return n=t.isArray(n)?n:[n],e=t.isArray(e)?e:[e],t.each(n,function(n){var o=n.topic||"#";t.each(e,function(e){var c=e.channel||r.configuration.DEFAULT_CHANNEL;i.push(r.subscribe({channel:n.channel||r.configuration.DEFAULT_CHANNEL,topic:o,callback:function(n,i){var o=t.clone(i);o.topic=t.isFunction(e.topic)?e.topic(i.topic):e.topic||i.topic,o.channel=c,o.data=n,r.publish(o)}}))})}),i},e&&Object.prototype.hasOwnProperty.call(e,"__postalReady__")&&t.isArray(e.__postalReady__))for(;e.__postalReady__.length;)e.__postalReady__.shift().onReady(l);return l}),"object"==typeof module&&"function"!=typeof i)var i=function(t){module.exports=t(e,exports,module)};if(i("lib/backbone-facade",["require","exports","module","postal"],function(t){var n=t("postal"),e=/\s+/,i=/^@/,r={ALL:"all"};return{on:function(t,o,c,s){var a,u,l=function(t,n){var e;return 3===arguments.length&&(e=arguments[0],t=arguments[1],n=arguments[2]),"function"==typeof c?e===r.ALL?c.apply(this,[n.topic].concat(t.__args)):c.apply(this,t.__args):void 0};if("string"!=typeof t)return this;for(i.test(t)?t=t.substr(1):(s=c,c=o,o=t,t=null),l.__original=c,null==s&&(s=this),!t&&this instanceof n.ChannelDefinition&&(t=this.channel),o=o.split(e);a=o.shift();)u=n.subscribe({channel:t,topic:"all"===a?"*":a,callback:"all"===a?l.bind(null,r.ALL):l}),u.callback.context(s);return this},off:function(t,r,o,c){var s,a,u;if("string"==typeof t&&i.test(t)?t=t.substr(1):(c=o,o=r,r=t,t=null),!t&&this instanceof n.ChannelDefinition&&(t=this.channel),a=n.subscriptions[t||n.configuration.DEFAULT_CHANNEL],!a)return this;for(r=null!=r?r.split(e):Object.keys(a);s=r.shift();)u=a["all"===s?"*":s]||[],u=u.filter(function(t){return(null!=o?t.callback.target().__original===o:!0)&&(null!=c?t.callback.context()===c:!0)}),n.unsubscribe.apply(n,u);return this},trigger:function(t,r){var o,c={__args:null};if("string"!=typeof t)return this;for(i.test(t)?(t=t.substr(1),c.__args=Array.prototype.slice.call(arguments,2)):(c.__args=Array.prototype.slice.call(arguments,1),r=t,t=null),!t&&this instanceof n.ChannelDefinition&&(t=this.channel),r=r.split(e);o=r.shift();)n.publish({channel:t,topic:o,data:c});return this}}}),"object"==typeof module&&"function"!=typeof i)var i=function(t){module.exports=t(e,exports,module)};if(i("lib/preserve",["require","exports","module"],function(){return function(t){var n={};t.addWireTap(function(t,e){var i=!1;/^\!/.test(e.topic)&&(i=!0,e.topic=e.topic.substr(1)),n[e.channel]=n[e.channel]||{},i?n[e.channel][e.topic]=t:e.topic in n[e.channel]&&delete n[e.channel][e.topic]});var e=t.SubscriptionDefinition.prototype,i=e.subscribe;return e.subscribe=function(){var t=i.apply(this,arguments),e=this;return n[this.channel]&&this.topic in n[this.channel]&&setTimeout(function(){var t=n[e.channel][e.topic];e.callback(t,{channel:e.channel,topic:e.topic,timeStamp:new Date,data:t})},10),t},t}}),"object"==typeof module&&"function"!=typeof i)var i=function(t){module.exports=t(e,exports,module)};return i("index",["require","exports","module","postal","./lib/backbone-facade","./lib/preserve"],function(t){function n(t){for(var n,e=1,i=arguments.length;i>e;e++)if(n=arguments[e])for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t}var e=t("postal"),i=t("./lib/backbone-facade"),r=t("./lib/preserve");return n(e.ChannelDefinition.prototype,i),n(r(e),i)}),i("lodash",function(){return t}),e("index")});